{"id": "Set_Service_Information_windows", "name": "Set Service Information", "description": "ADVANCED SCRIPT\nThe script enables the modification of the status and startup type of one or multiple services, which are provided as input. Useful for enforcing the expected status of critical services (e.g. Antivirus, SCCM agent, core business applications, etc.) in accordance with corporate policies.", "purpose": ["REMEDIATION"], "targeting": {"apiEnabled": true, "manualEnabled": true, "manualAllowMultipleDevices": true}, "scriptInfo": {"runAs": "LOCAL_SYSTEM", "timeoutSeconds": 120, "inputs": [{"description": "The service (or comma-separated list of services) whose status or startup type will be modified. Service names are case-insensitive", "id": "ServiceName", "name": "ServiceName", "options": ["''"], "allowCustomValue": false, "usedByWindows": true, "usedByMacOs": false}, {"description": "The action (or comma-separated list of actions) to apply to the status of the specified service (or comma-separated list of services)", "id": "StatusChange", "name": "StatusChange", "options": ["''"], "allowCustomValue": false, "usedByWindows": true, "usedByMacOs": false}, {"description": "The startup type (or comma-separated list of startup types) to apply to the specified service (or comma-separated list of services)", "id": "SetStartTypeTo", "name": "SetStartTypeTo", "options": ["''"], "allowCustomValue": false, "usedByWindows": true, "usedByMacOs": false}], "outputs": [{"description": "Name, status, and startup type of the requested service (or list of services) before and after the change", "id": "UpdatedServiceStatus", "name": "UpdatedServiceStatus", "type": "list_of_strings", "usedByWindows": true, "usedByMacOs": false}], "scriptWindows": {"name": "Set-ServiceInformation.ps1", "script": "77u/PCMNCi5TWU5PUFNJUw0KU2V0cyB0aGUgc3RhdHVzIGFuZCBzdGFydHVwIHR5cGUgb2YgV2luZG93cyBzZXJ2aWNlcy4NCg0KLkRFU0NSSVBUSU9ODQpBRFZBTkNFRCBTQ1JJUFQNClRoZSBzY3JpcHQgZW5hYmxlcyB0aGUgbW9kaWZpY2F0aW9uIG9mIHRoZSBzdGF0dXMgYW5kIHN0YXJ0dXAgdHlwZSBvZiBvbmUgb3IgbXVsdGlwbGUgc2VydmljZXMsIHdoaWNoIGFyZSBwcm92aWRlZCBhcyBpbnB1dC4gVXNlZnVsIGZvciBlbmZvcmNpbmcgdGhlIGV4cGVjdGVkIHN0YXR1cyBvZiBjcml0aWNhbCBzZXJ2aWNlcyAoZS5nLiBBbnRpdmlydXMsIFNDQ00gYWdlbnQsIGNvcmUgYnVzaW5lc3MgYXBwbGljYXRpb25zLCBldGMuKSBpbiBhY2NvcmRhbmNlIHdpdGggY29ycG9yYXRlIHBvbGljaWVzLg0KDQouRlVOQ1RJT05BTElUWQ0KUmVtZWRpYXRpb24NCg0KLklOUFVUUw0KSUQgIExhYmVsICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVzY3JpcHRpb24NCjEgICBTZXJ2aWNlTmFtZSAgICAgICAgICAgICAgICAgICAgIFRoZSBzZXJ2aWNlIChvciBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBzZXJ2aWNlcykgd2hvc2Ugc3RhdHVzIG9yIHN0YXJ0dXAgdHlwZSB3aWxsIGJlIG1vZGlmaWVkLiBTZXJ2aWNlIG5hbWVzIGFyZSBjYXNlLWluc2Vuc2l0aXZlDQoyICAgU3RhdHVzQ2hhbmdlICAgICAgICAgICAgICAgICAgICBUaGUgYWN0aW9uIChvciBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBhY3Rpb25zKSB0byBhcHBseSB0byB0aGUgc3RhdHVzIG9mIHRoZSBzcGVjaWZpZWQgc2VydmljZSAob3IgY29tbWEtc2VwYXJhdGVkIGxpc3Qgb2Ygc2VydmljZXMpDQozICAgU2V0U3RhcnRUeXBlVG8gICAgICAgICAgICAgICAgICBUaGUgc3RhcnR1cCB0eXBlIChvciBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBzdGFydHVwIHR5cGVzKSB0byBhcHBseSB0byB0aGUgc3BlY2lmaWVkIHNlcnZpY2UgKG9yIGNvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIHNlcnZpY2VzKQ0KDQouT1VUUFVUUw0KSUQgIExhYmVsICAgICAgICAgICAgICAgICAgICAgICAgICAgVHlwZSAgICAgICAgICAgIERlc2NyaXB0aW9uDQoxICAgVXBkYXRlZFNlcnZpY2VTdGF0dXMgICAgICAgICAgICBTdHJpbmdMaXN0ICAgICAgTmFtZSwgc3RhdHVzLCBhbmQgc3RhcnR1cCB0eXBlIG9mIHRoZSByZXF1ZXN0ZWQgc2VydmljZSAob3IgbGlzdCBvZiBzZXJ2aWNlcykgYmVmb3JlIGFuZCBhZnRlciB0aGUgY2hhbmdlDQoNCi5GVVJUSEVSIElORk9STUFUSU9ODQpUeXBlICIiIGlmIHlvdSBkbyBub3Qgd2lzaCB0byBjaGFuZ2UgZWl0aGVyIHRoZSBzdGF0dXMgb3IgdGhlIHN0YXJ0dXAgdHlwZSBvZiBhIHBhcnRpY3VsYXIgc2VydmljZS4NCkJvdGggYWN0aW9uIG5hbWVzIGFuZCBzdGFydHVwIHR5cGUgbmFtZXMgYXJlIGNhc2UtaW5zZW5zaXRpdmUuDQpWYWxpZCBhY3Rpb25zOiBTdGFydCwgU3RvcCwgUmVzdGFydCwgUGF1c2UsIFJlc3VtZS4NClZhbGlkIHN0YXJ0dXAgdHlwZXM6IEF1dG8sIEF1dG8gKERlbGF5ZWQgU3RhcnQpLCBNYW51YWwsIERpc2FibGVkLg0KRmluZCB0aGUgbmFtZXMgb2YgdGhlIGF2YWlsYWJsZSBzZXJ2aWNlcyBpbiBhIGRldmljZSBieSBvcGVuaW5nIHRoZSBTZXJ2aWNlcyB0YWIgb2YgdGhlIFRhc2sgTWFuYWdlciAobG9vayB1bmRlciB0aGUgTmFtZSBjb2x1bW4pLg0KQmVjYXVzZSBvZiB0aGUgdW5wcmVkaWN0YWJsZSBiZWhhdmlvciBvZiBXaW5kb3dzIHNlcnZpY2VzLCBub3RlIHRoYXQgeW91ciBjaGFuZ2VzIG1heSBiZSBvdmVyd3JpdHRlbi4NCg0KQURWQU5DRUQ6DQpUaGlzIHNjcmlwdCByZXF1aXJlcyBjdXN0b21pemF0aW9uIGJ5IGFuIGV4cGVydCBhbmQgbmVlZHMgdG8gYmUgdGhvcm91Z2hseSB0ZXN0ZWQuIFRoZSBwb3RlbnRpYWwgaW1wYWN0IG9uIHlvdXIgZW52aXJvbm1lbnQgbWlnaHQgYWxzbyByZXF1aXJlIHNpZ24gb2ZmIGZyb20gdGhlIFNlY3VyaXR5IFRlYW0uDQpQbGVhc2UsIGVuc3VyZSB0aGF0IHlvdSBkb24ndCBzdG9wIG9yIGRpc2FibGUgZXNzZW50aWFsIFdpbmRvd3Mgc2VydmljZXMuDQoNCi5SRVNUUklDVElPTlMNCi0gV2hlbiBzZXR0aW5nIHRoZSBzdGFydHVwIHR5cGUgdG8gRGlzYWJsZWQsIG9ubHkgU3RvcCBhbmQgIiIgKGVtcHR5IGFjdGlvbikgYXJlIHZhbGlkIGFjdGlvbnMgZm9yIHNldHRpbmcgdGhlIHN0YXR1cy4NCi0gVGhlIGFjdGlvbiBBdXRvIChEZWxheWVkIFN0YXJ0KSBpcyBvbmx5IHZhbGlkIGlmIHRoZSByZWdpc3RyeSBrZXkgRGVsYXllZEF1dG9TdGFydCBleGlzdHMgdW5kZXI6DQpIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcc2VydmljZXMqDQotIFRoZSBzY3JpcHQgU2V0IHNlcnZpY2Ugc3RhdHVzIGFuZCBzdGFydHVwIHR5cGUgY2Fubm90IG1vZGlmeSB0aGUgc3RhcnR1cCB0eXBlIG9mIFdpbmRvd3Mgc2VydmljZXMgdGhhdCBhcmUgdHJpZ2dlcmVkIGJ5IGV2ZW50cy4NCi0gVGhpcyBzY3JpcHQgaXMgbm90IHNpZ25lZCBieSBOZXh0aGluayBkdWUgdG8gc2VjdXJpdHkgY29uY2VybnMuDQoNCi5OT1RFUw0KQ29udGV4dDogICAgICAgICAgICBMb2NhbFN5c3RlbQ0KVmVyc2lvbjogICAgICAgICAgICAxLjEuMC4wIC0gUmVtb3ZlZCBkaWdpdGFsIHNpZ25hdHVyZQ0KICAgICAgICAgICAgICAgICAgICAxLjAuMC4wIC0gSW5pdGlhbCByZWxlYXNlDQpMYXN0IEdlbmVyYXRlZDogICAgIDI4IFNlcCAyMDIwIC0gMDk6MzQ6NTkNCkNvcHlyaWdodCAoQykgMjAyMCBOZXh0aGluayBTQSwgU3dpdHplcmxhbmQNCiM+DQojDQojIElucHV0IHBhcmFtZXRlcnMgZGVmaW5pdGlvbg0KIw0KcGFyYW0oDQogICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldW3N0cmluZ10kU2VydmljZU5hbWUsDQogICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkZmFsc2UpXVtzdHJpbmddJFN0YXR1c0NoYW5nZSwNCiAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldW3N0cmluZ10kU2V0U3RhcnRUeXBlVG8NCikNCiMgRW5kIG9mIHBhcmFtZXRlcnMgZGVmaW5pdGlvbg0KDQpmdW5jdGlvbiBhc19sb2NhbF9zeXN0ZW0oKSB7DQogICAgJGlkID0gW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkNCiAgICByZXR1cm4gJGlkLlVzZXIuVG9TdHJpbmcoKSAtZXEgIlMtMS01LTE4Ig0KfQ0KDQokTmV3TGluZSA9IFtFbnZpcm9ubWVudF06Ok5ld0xpbmUNCg0KZnVuY3Rpb24gVGVzdC1QYXJhbWV0ZXJzIChbc3RyaW5nW11dJHNlcnZpY2VOYW1lTGlzdCwgW3N0cmluZ1tdXSRzZXJ2aWNlc1N0YXR1c0xpc3QsIFtzdHJpbmdbXV0kc2VydmljZXNTdGFydFR5cGVMaXN0KSB7DQoNCiAgICBpZiAoJHNlcnZpY2VOYW1lTGlzdC5MZW5ndGggLW5lICRzZXJ2aWNlc1N0YXR1c0xpc3QuTGVuZ3RoIC1vciAkc2VydmljZXNTdGF0dXNMaXN0Lkxlbmd0aCAtbmUgJHNlcnZpY2VzU3RhcnRUeXBlTGlzdC5MZW5ndGgpIHsNCiAgICAgICAgJGV4TWVzc2FnZSA9IEAiDQpFYWNoIHZhcmlhYmxlIGAkU2VydmljZU5hbWUsIGAkU3RhdHVzQ2hhbmdlIGFuZCBgJFNldFN0YXJ0VHlwZVRvIHNob3VsZCBoYXZlIHRoZSBzYW1lIG51bWJlciBvZiBhcmd1bWVudHMuRW1wdHkgYXJndW1lbnQNCmNhbiBiZSByZXBsYWNlZCBieSBkb3VibGUgcXVvdGVzLiBZb3UgcGFzc2VkIHRoZXNlIG51bWJlciBvZiBhcmd1bWVudHM6IGAkU2VydmljZU5hbWUgPSAkKCRzZXJ2aWNlTmFtZUxpc3QuTGVuZ3RoKSwgYCRTdGF0dXNDaGFuZ2UgPSAkKCRzZXJ2aWNlc1N0YXR1c0xpc3QuTGVuZ3RoKSwgYCRTZXRTdGFydFR5cGVUbyA9ICQoJHNlcnZpY2VzU3RhcnRUeXBlTGlzdC5MZW5ndGgpLg0KIkANCiAgICAgICAgdGhyb3cgJGV4TWVzc2FnZQ0KICAgIH0NCg0KICAgICMgVmFsaWRhdGVTZXQgZm9yIGFyZ3VtZW50ICRTdGF0dXNDaGFuZ2UNCiAgICAkc2VydmljZVN0YXR1c1NldCA9IEAoJ1N0YXJ0JywgJ1N0b3AnLCAnUmVzdGFydCcsICdQYXVzZScsICdSZXN1bWUnLCAnIiInKQ0KDQogICAgZm9yZWFjaCAoJHNydlN0YXR1cyBpbiAkc2VydmljZXNTdGF0dXNMaXN0KSB7DQogICAgICAgIGlmICgkc2VydmljZVN0YXR1c1NldCAtbm90Y29udGFpbnMgJHNydlN0YXR1cyApIHsNCiAgICAgICAgICAgIHRocm93ICInJHNydlN0YXR1cycgaXMgbm90IGEgdmFsaWQgc2VydmljZSBzdGF0dXMuIFRoZSBgJFN0YXR1c0NoYW5nZSBwYXJhbWV0ZXIgc3VwcG9ydHMgb25seSAnU3RhcnQnLCAnU3RvcCcsICdSZXN0YXJ0JywgJ1BhdXNlJywgJ1Jlc3VtZScgb3IgJyIiJyB2YWx1ZXMuIg0KICAgICAgICB9DQogICAgfQ0KDQogICAgIyBWYWxpZGF0ZVNldCBmb3IgYXJndW1lbnQgJFNldFN0YXJ0VHlwZVRvDQogICAgJHNlcnZpY2VTdGFydFR5cGVTZXQgPSBAKCdBdXRvJywgJ01hbnVhbCcsICdEaXNhYmxlZCcsICdBdXRvIChEZWxheWVkIFN0YXJ0KScsICciIicpDQogICAgZm9yZWFjaCAoJHNydlN0YXJ0VHlwZSBpbiAkc2VydmljZXNTdGFydFR5cGVMaXN0KSB7DQogICAgICAgIGlmICgkc2VydmljZVN0YXJ0VHlwZVNldCAtbm90Y29udGFpbnMgJHNydlN0YXJ0VHlwZSApIHsNCiAgICAgICAgICAgIHRocm93ICInJHNydlN0YXJ0VHlwZScgaXMgbm90IGEgdmFsaWQgc2VydmljZSBzdGFydCB0eXBlLiBUaGUgYCRTZXRTdGFydFR5cGVUbyBwYXJhbWV0ZXIgc3VwcG9ydHMgb25seSAnQXV0bycsICdBdXRvIChEZWxheWVkIFN0YXJ0KScsICdEaXNhYmxlZCcsICdNYW51YWwnIG9yICciIicgdmFsdWVzLiINCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvciAoJGkgPSAwOyAkaSAtbHQgJHNlcnZpY2VOYW1lTGlzdC5Db3VudDsgJGkrKykgew0KICAgICAgICBpZiAoKCRzZXJ2aWNlc1N0YXJ0VHlwZUxpc3RbJGldIC1lcSAnIiInKSAtYW5kICgkc2VydmljZXNTdGF0dXNMaXN0WyRpXSAtZXEgJyIiJykpIHsNCiAgICAgICAgICAgIHRocm93ICJCb3RoIHNjcmlwdCBhcmd1bWVudHMgJ2AkU3RhdHVzQ2hhbmdlJyBhbmQgJ2AkU2V0U3RhcnRUeXBlVG8nIGFyZSBlbXB0eS4gUGxlYXNlIHByb3ZpZGUgYXQgbGVhc3Qgb25lLiINCiAgICAgICAgfQ0KICAgIH0NCg0KDQogICAgIyBXaGVuIHN0YXJ0IHR5cGUgaXMgJ0Rpc2FibGVkJyBvbmx5IGFsbG93IHVzZXIgdG8gY2hhbmdlIHN0YXR1cyB0byAnU3RvcCcNCiAgICAkYWN0aXZlU2VydmljZVN0YXJ0VHlwZVNldCA9IEAoJ0F1dG8nLCAnTWFudWFsJywgJ0F1dG8gKERlbGF5ZWQgU3RhcnQpJywgJyIiJykNCiAgICBmb3IgKCRpID0gMDsgJGkgLWx0ICRzZXJ2aWNlTmFtZUxpc3QuQ291bnQ7ICRpKyspIHsNCiAgICAgICAgaWYgKCgkc2VydmljZXNTdGFydFR5cGVMaXN0WyRpXSAtZXEgIkRpc2FibGVkIiAtYW5kICRzZXJ2aWNlc1N0YXR1c0xpc3RbJGldIC1lcSAiU3RvcCIpIC1vciBgDQogICAgICAgICAgICAoJHNlcnZpY2VzU3RhcnRUeXBlTGlzdFskaV0gLWVxICJEaXNhYmxlZCIgLWFuZCAkc2VydmljZXNTdGF0dXNMaXN0WyRpXSAtZXEgJyIiJykgLW9yIGANCiAgICAgICAgICAgICgkYWN0aXZlU2VydmljZVN0YXJ0VHlwZVNldCAtY29udGFpbnMgJHNlcnZpY2VzU3RhcnRUeXBlTGlzdFskaV0gLWFuZCAkc2VydmljZVN0YXR1c1NldCAtY29udGFpbnMgJHNlcnZpY2VzU3RhdHVzTGlzdFskaV0pKSB7DQogICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGV4TWVzc2FnZSA9IEAiDQpTZXJ2aWNlICckKCRzZXJ2aWNlTmFtZUxpc3RbJGldKScgY2Fubm90IGhhdmUgc3RhcnQgdHlwZSAnRGlzYWJsZWQnIGFuZCBzdGF0dXMgJ1N0YXJ0JywgUmVzdGFydCcsICdQYXVzZScgb3IgJ1Jlc3VtZScgIGF0IHRoZSBzYW1lIHRpbWUuDQpQbGVhc2UgcmV2aWV3IHJlbW90ZSBhY3Rpb24gYXJndW1lbnRzLg0KIkANCiAgICAgICAgICAgIHRocm93ICRleE1lc3NhZ2UNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gU3BsaXQtU3RyaW5nQXJndW1lbnQgKFtzdHJpbmddJGFyZywgW3N0cmluZ10kZGVsaW1pdGVyID0gJywnKSB7DQogICAgW3N0cmluZ1tdXSRhcmdMaXN0ID0gJGFyZy5TcGxpdCgkZGVsaW1pdGVyKSB8IEZvckVhY2gtT2JqZWN0IHskXy5UcmltKCl9DQogICAgJGFyZ0xpc3QNCn0NCg0KZnVuY3Rpb24gTWVyZ2UtU3RhcnRUeXBlSW5mbyhbc3RyaW5nXSRzZXJ2aWNlTmFtZSwgW3N0cmluZ10kc3RhcnRUeXBlLCBbc3RyaW5nW11dJGRlbGF5ZWRTZXJ2aWNlKSB7DQoNCiAgICAkc3RhcnRUeXBlUGFyYW1zID0gQCgpDQogICAgJHN0YXJ0VHlwZUluZm8gPSAnJw0KDQogICAgIyBDYXNlIGluc2Vuc2l0aXZlIHN0cmluZyBjb21wYXJpc29uDQogICAgaWYgKCRkZWxheWVkU2VydmljZSAtY29udGFpbnMgJHNlcnZpY2VOYW1lKSB7DQogICAgICAgICRzdGFydFR5cGVQYXJhbXMgKz0gIkRlbGF5ZWQgU3RhcnQiDQogICAgfQ0KDQogICAgJGlzU2VydmljZVRyaWdnZXJlZCA9IFRlc3QtVHJpZ2dlclN0YXJ0U2VydmljZSAkc2VydmljZU5hbWUNCiAgICBpZiAoJGlzU2VydmljZVRyaWdnZXJlZCkgew0KICAgICAgICAkc3RhcnRUeXBlUGFyYW1zICs9ICJUcmlnZ2VyIFN0YXJ0Ig0KICAgIH0NCg0KICAgIHN3aXRjaCAoJHN0YXJ0VHlwZVBhcmFtcy5Db3VudCkgew0KICAgICAgICAwIHsgJHN0YXJ0VHlwZUluZm8gPSAkc3RhcnRUeXBlIDsgYnJlYWt9DQogICAgICAgIDEgeyAkc3RhcnRUeXBlSW5mbyA9ICIkc3RhcnRUeXBlICgkKCRzdGFydFR5cGVQYXJhbXNbMF0pKSIgOyBicmVhayB9DQogICAgICAgIDIgeyAkc3RhcnRUeXBlSW5mbyA9ICIkc3RhcnRUeXBlIChEZWxheWVkIFN0YXJ0LCBUcmlnZ2VyIFN0YXJ0KSIgOyBicmVhayB9DQogICAgICAgIGRlZmF1bHQgeyAkc3RhcnRUeXBlSW5mbyA9ICRzdGFydFR5cGUgOyBicmVhayB9DQogICAgfQ0KDQogICAgJHN0YXJ0VHlwZUluZm8NCn0NCg0KZnVuY3Rpb24gR2V0LVNlcnZpY2VQcm9wZXJ0eSAoW3N0cmluZ1tdXSRzZXJ2aWNlTmFtZUxpc3QpIHsNCg0KICAgICRzZXJ2aWNlUHJvcGVydHlMaXN0ID0gQCgpDQogICAgIyBSZWFkIGZyb20gcmVnaXN0cnkgbGlzdCBhbGwgZGVsYXllZCBzZXJ2aWNlcyANCiAgICAkZGVsYXllZFNlcnZpY2UgPSBHZXQtRGVsYXllZFNlcnZpY2UNCg0KICAgIGZvcmVhY2ggKCRzIGluICRzZXJ2aWNlTmFtZUxpc3QpIHsNCiAgICAgICAgJHNlcnZpY2VQcm9wZXJ0eSA9IEdldC1TZXJ2aWNlICRzIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgYA0KICAgICAgICAgICAgU2VsZWN0LU9iamVjdCBOYW1lLCBTZXJ2aWNlTmFtZSwgRGlzcGxheU5hbWUsIFN0YXR1cywgQ2FuUGF1c2VBbmRDb250aW51ZQ0KICAgICAgICAkc3RhcnRUeXBlID0gR2V0LVdtaU9iamVjdCBXaW4zMl9TZXJ2aWNlIC1GaWx0ZXIgIk5hbWU9JyRzJyIgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBTdGFydE1vZGUNCg0KICAgICAgICBpZiAoJHNlcnZpY2VQcm9wZXJ0eSAtbmUgJG51bGwpIHsNCiAgICAgICAgICAgICRzdGFydFR5cGVJbmZvID0gTWVyZ2UtU3RhcnRUeXBlSW5mbyAkc2VydmljZVByb3BlcnR5LlNlcnZpY2VOYW1lICRzdGFydFR5cGUgJGRlbGF5ZWRTZXJ2aWNlDQogICAgICAgICAgICAkc2VydmljZVByb3BlcnR5IHwgQWRkLU1lbWJlciDigJNNZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSDigJNOYW1lIFN0YXJ0VHlwZSDigJNWYWx1ZSAkc3RhcnRUeXBlSW5mbw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgIyBTZXJ2aWNlIGNhbm5vdCBiZSBmb3VuZCBieSBHZXQtU2VydmljZSBjb21tYW5kDQogICAgICAgICAgICAkc2VydmljZVByb3BlcnR5ID0gTmV3LU9iamVjdCDigJNUeXBlTmFtZSBwc29iamVjdA0KICAgICAgICAgICAgJHNlcnZpY2VQcm9wZXJ0eSB8IEFkZC1NZW1iZXIg4oCTTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkg4oCTTmFtZSBOYW1lIOKAk1ZhbHVlICRzDQogICAgICAgICAgICAkc2VydmljZVByb3BlcnR5IHwgQWRkLU1lbWJlciDigJNNZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSDigJNOYW1lIERpc3BsYXlOYW1lIOKAk1ZhbHVlICRudWxsDQogICAgICAgIH0NCiAgICAgICAgJHNlcnZpY2VQcm9wZXJ0eUxpc3QgKz0gJHNlcnZpY2VQcm9wZXJ0eQ0KICAgIH0NCiAgICAkc2VydmljZVByb3BlcnR5TGlzdA0KfQ0KDQpmdW5jdGlvbiBTZXQtU2VydmljZVN0YXJ0VHlwZShbcHNvYmplY3RbXV0kc2VydmljZVByb3BlcnR5TGlzdCwgW3N0cmluZ1tdXSRzZXJ2aWNlc1N0YXJ0VHlwZUxpc3QpIHsNCg0KICAgIGZ1bmN0aW9uIFdhaXQtU2VydmljZVN0YXJ0VHlwZUNoYW5nZSgkc2VydmljZU5hbWUsICRleHBlY3RlZFN0YXJ0VHlwZSkgew0KICAgICAgICAkd2F0Y2hEb2dUaW1lciA9IDIwDQoNCiAgICAgICAgZm9yICgkaSA9IDA7ICRpIC1sdCAkd2F0Y2hEb2dUaW1lcjsgJGkrKykgew0KICAgICAgICAgICAgJGN1cnJlbnRTdGFydFR5cGUgPSBHZXQtV21pT2JqZWN0IFdpbjMyX1NlcnZpY2UgLUZpbHRlciAiTmFtZT0nJHNlcnZpY2VOYW1lJyIgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBTdGFydE1vZGUNCiAgICAgICAgICAgIGlmICgkY3VycmVudFN0YXJ0VHlwZSAtZXEgJGV4cGVjdGVkU3RhcnRUeXBlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICR0cnVlDQogICAgICAgICAgICB9DQogICAgICAgICAgICBTdGFydC1TbGVlcCAtTWlsbGlzZWNvbmRzIDEwMDANCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gJGZhbHNlDQogICAgfQ0KDQogICAgJGVhID0gJEVycm9yQWN0aW9uUHJlZmVyZW5jZQ0KICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScNCiAgICAkYWN0aXZlRGVsYXllZFNlcnZpY2VzID0gR2V0LUl0ZW1Qcm9wZXJ0eSBIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcc2VydmljZXNcKiBgDQogICAgICAgIHwgV2hlcmUtT2JqZWN0IHsgJF8uRGVsYXllZEF1dG9TdGFydCAtZXEgMSB9IHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgUFNDaGlsZE5hbWUNCiAgICAkYWxsRGVsYXllZFNlcnZpY2VzID0gR2V0LUl0ZW1Qcm9wZXJ0eSBIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcc2VydmljZXNcKiBgDQogICAgICAgIHwgV2hlcmUtT2JqZWN0IHsgJF8uRGVsYXllZEF1dG9TdGFydCAtbmUgJG51bGwgfSB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IFBTQ2hpbGROYW1lDQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICRlYQ0KDQogICAgZm9yICgkaSA9IDA7ICRpIC1sdCAkc2VydmljZVByb3BlcnR5TGlzdC5Db3VudDsgJGkrKykgew0KDQogICAgICAgICMgU2VydmljZSBjb3VsZCBub3QgYmUgZm91bmQgYnkgR2V0LVNlcnZpY2VQcm9wZXJ0eSwgc2tpcCBpdA0KICAgICAgICBpZiAoJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldLkRpc3BsYXlOYW1lIC1lcSAkbnVsbCkgew0KICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkc2VydmljZVByb3BlcnR5TGlzdFskaV0uU3RhcnRUeXBlIC1uZSAkc2VydmljZXNTdGFydFR5cGVMaXN0WyRpXSkgew0KICAgICAgICAgICAgc3dpdGNoICgkc2VydmljZXNTdGFydFR5cGVMaXN0WyRpXSkgew0KICAgICAgICAgICAgICAgIHsgIkF1dG8gKERlbGF5ZWQgU3RhcnQpIiwgIkF1dG8iIC1jb250YWlucyAkX30gew0KICAgICAgICAgICAgICAgICAgICBTZXQtU2VydmljZSAkc2VydmljZVByb3BlcnR5TGlzdFskaV0uTmFtZSAtU3RhcnR1cFR5cGUgQXV0b21hdGljIC1QYXNzVGhydSB8IE91dC1OdWxsDQogICAgICAgICAgICAgICAgICAgIFdhaXQtU2VydmljZVN0YXJ0VHlwZUNoYW5nZSAkc2VydmljZVByb3BlcnR5TGlzdFskaV0uTmFtZSAnQXV0bycgfCBPdXQtTnVsbA0KICAgICAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAiTWFudWFsIiB7DQogICAgICAgICAgICAgICAgICAgIFNldC1TZXJ2aWNlICRzZXJ2aWNlUHJvcGVydHlMaXN0WyRpXS5OYW1lIC1TdGFydHVwVHlwZSBNYW51YWwgLVBhc3NUaHJ1IHwgT3V0LU51bGwNCiAgICAgICAgICAgICAgICAgICAgV2FpdC1TZXJ2aWNlU3RhcnRUeXBlQ2hhbmdlICRzZXJ2aWNlUHJvcGVydHlMaXN0WyRpXS5OYW1lICdNYW51YWwnIHwgT3V0LU51bGwNCiAgICAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgIkRpc2FibGVkIiB7DQogICAgICAgICAgICAgICAgICAgIFNldC1TZXJ2aWNlICRzZXJ2aWNlUHJvcGVydHlMaXN0WyRpXS5OYW1lIC1TdGFydHVwVHlwZSBEaXNhYmxlZCAtUGFzc1RocnUgfCBPdXQtTnVsbA0KICAgICAgICAgICAgICAgICAgICBXYWl0LVNlcnZpY2VTdGFydFR5cGVDaGFuZ2UgJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldLk5hbWUgJ0Rpc2FibGVkJyB8IE91dC1OdWxsDQogICAgICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGRlZmF1bHQgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAjIFVzZXIgZG9lcyBub3QgcHJvdmlkZSBhbnkgU3RhcnQgdHlwZSBhbmQgZGVsYXkgZmxhZyBleGlzdHMgYW5kIGhhcyB2YWx1ZSAxDQogICAgICAgIGlmICgoJHNlcnZpY2VzU3RhcnRUeXBlTGlzdFskaV0gLWVxICciIicgLWFuZCAkYWN0aXZlRGVsYXllZFNlcnZpY2VzIC1jb250YWlucyAkc2VydmljZVByb3BlcnR5TGlzdFskaV0uTmFtZSkpIHsNCiAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgIH0NCg0KICAgICAgICAjICcoRGVsYXkgU3RhcnQpJyBpcyBtYXRjaGVkIGFuZCBzZXJ2aWNlIGRlbGF5ZWQgZmxhZyBleGlzdHMgYW5kIGhhcyBhbnkgdmFsdWUNCiAgICAgICAgaWYgKCRzZXJ2aWNlc1N0YXJ0VHlwZUxpc3RbJGldIC1saWtlICIqKERlbGF5ZWQgU3RhcnQpIiAtYW5kICRhbGxEZWxheWVkU2VydmljZXMgLWNvbnRhaW5zICRzZXJ2aWNlUHJvcGVydHlMaXN0WyRpXS5OYW1lKSB7DQogICAgICAgICAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICJIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcc2VydmljZXNcJCgkc2VydmljZVByb3BlcnR5TGlzdFskaV0uTmFtZSkiIGANCiAgICAgICAgICAgICAgICAtTmFtZSBEZWxheWVkQXV0b1N0YXJ0IC1WYWx1ZSAxIC1Qcm9wZXJ0eVR5cGUgRFdPUkQgLUZvcmNlIHwgT3V0LU51bGwNCiAgICAgICAgfQ0KICAgICAgICAjICcoRGVsYXkgU3RhcnQpJyBpcyBub3QgbWF0Y2hlZCBhbmQgc2VydmljZSBkZWxheWVkIGZsYWcgZXhpc3RzIGFuZCBoYXMgYW55IHZhbHVlDQogICAgICAgIGlmICgkc2VydmljZXNTdGFydFR5cGVMaXN0WyRpXSAtbm90bGlrZSAiKihEZWxheWVkIFN0YXJ0KSIgLWFuZCAkYWxsRGVsYXllZFNlcnZpY2VzIC1jb250YWlucyAkc2VydmljZVByb3BlcnR5TGlzdFskaV0uTmFtZSkgew0KICAgICAgICAgICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XHNlcnZpY2VzXCQoJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldLk5hbWUpIiBgDQogICAgICAgICAgICAgICAgLU5hbWUgRGVsYXllZEF1dG9TdGFydCAtVmFsdWUgMCAtUHJvcGVydHlUeXBlIERXT1JEIC1Gb3JjZSB8IE91dC1OdWxsDQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIFNldC1TZXJ2aWNlU3RhdHVzKFtwc29iamVjdFtdXSRzZXJ2aWNlUHJvcGVydHlMaXN0LCBbc3RyaW5nW11dJHNlcnZpY2VzU3RhdHVzTGlzdCwgW3N0cmluZ1tdXSRzZXJ2aWNlc1N0YXJ0VHlwZUxpc3QpIHsNCg0KICAgICMgJHNlcnZpY2VQcm9wZXJ0eUxpc3QgLSBsaXN0IG9mIHNlcnZpY2VzJyBwcm9wZXJ0aWVzIFtjdXN0b20gb2JqZWN0c10gY29sbGVjdGVkIGJ5IEdldC1TZXJ2aWNlUHJvcGVydHkNCiAgICAjICRzZXJ2aWNlc1N0YXR1c0xpc3QgLSBsaXN0IG9mIHNlcnZpY2VzJyBzdGF0dXNlcyBbc3RyaW5nc10gcHJvdmlkZWQgYnkgdXNlcg0KDQogICAgZnVuY3Rpb24gU3RhcnQtU2VydmljZUhlbHBlcigkc2VydmljZSkgew0KDQogICAgICAgIGlmICgkc2VydmljZS5TdGF0dXMgLW5lICdTdGFydFBlbmRpbmcnKSB7DQogICAgICAgICAgICBTdGFydC1TZXJ2aWNlICRzZXJ2aWNlLk5hbWUgLUVycm9yQWN0aW9uIENvbnRpbnVlIC1QYXNzVGhydSB8IE91dC1OdWxsDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBTdG9wLVNlcnZpY2VIZWxwZXIoJHNlcnZpY2UpIHsNCg0KICAgICAgICBpZiAoJHNlcnZpY2UuU3RhdHVzIC1uZSAnU3RvcFBlbmRpbmcnKSB7DQogICAgICAgICAgICBTdG9wLVNlcnZpY2UgJHNlcnZpY2UuTmFtZSAtRXJyb3JBY3Rpb24gQ29udGludWUgLUZvcmNlIC1QYXNzVGhydSB8IE91dC1OdWxsDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBSZXN0YXJ0LVNlcnZpY2VIZWxwZXIoJHNlcnZpY2UpIHsNCg0KICAgICAgICBpZiAoJHNlcnZpY2UuU3RhdHVzIC1uZSAnU3RhcnRQZW5kaW5nJyAtb3IgYA0KICAgICAgICAgICAgICAgICRzZXJ2aWNlLlN0YXR1cyAtbmUgJ1N0b3BQZW5kaW5nJyAtb3IgYA0KICAgICAgICAgICAgICAgICRzZXJ2aWNlLlN0YXR1cyAtbmUgJ1BhdXNlUGVuZGluZycgLW9yIGANCiAgICAgICAgICAgICAgICAkc2VydmljZS5TdGF0dXMgLW5lICdDb250aW51ZVBlbmRpbmcnKSB7DQogICAgICAgICAgICBSZXN0YXJ0LVNlcnZpY2UgJHNlcnZpY2UuTmFtZSAtRXJyb3JBY3Rpb24gQ29udGludWUgLUZvcmNlIC1QYXNzVGhydSB8IE91dC1OdWxsDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBTdXNwZW5kLVNlcnZpY2VIZWxwZXIoJHNlcnZpY2UpIHsNCg0KICAgICAgICBpZiAoJHNlcnZpY2UuQ2FuUGF1c2VBbmRDb250aW51ZSAtZXEgJGZhbHNlKSB7DQogICAgICAgICAgICB0aHJvdyAiJCgkc2VydmljZS5OYW1lKSBjYW5ub3QgYmUgcGF1c2VkIGJlY2F1c2UgaXQgZG9lcyBub3Qgc3VwcG9ydCB0aGlzIHN0YXRlLiINCiAgICAgICAgfQ0KICAgICAgICBpZiAoJHNlcnZpY2UuU3RhdHVzIC1uZSAnUGF1c2VQZW5kaW5nJykgew0KICAgICAgICAgICAgU3VzcGVuZC1TZXJ2aWNlICRzZXJ2aWNlLk5hbWUgLUVycm9yQWN0aW9uIENvbnRpbnVlIC1QYXNzVGhydSB8IE91dC1OdWxsDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBSZXN1bWUtU2VydmljZUhlbHBlcigkc2VydmljZSkgew0KDQogICAgICAgIGlmICgkc2VydmljZS5TdGF0dXMgLW5lICdDb250aW51ZVBlbmRpbmcnKSB7DQogICAgICAgICAgICBSZXN1bWUtU2VydmljZSAkc2VydmljZS5OYW1lIC1FcnJvckFjdGlvbiBDb250aW51ZSAtUGFzc1RocnUgfCBPdXQtTnVsbA0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yICgkaSA9IDA7ICRpIC1sdCAkc2VydmljZVByb3BlcnR5TGlzdC5Db3VudDsgJGkrKykgew0KDQogICAgICAgICMgU2VydmljZSBjb3VsZCBub3QgYmUgZm91bmQgYnkgR2V0LVNlcnZpY2VQcm9wZXJ0eSwgc2tpcCBpdA0KICAgICAgICBpZiAoJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldLkRpc3BsYXlOYW1lIC1lcSAkbnVsbCkgew0KICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgfQ0KDQogICAgICAgICMgSWYgc2VydmljZSBzdGFydCB0eXBlIGlzICdEaXNhYmxlZCcgZG8gbm90IGFsbG93IHRvIHNldCBhbnkgYWN0aXZlIHN0YXR1cw0KICAgICAgICAkYWN0aXZlU3RhdHVzZXMgPSBAKCdTdGFydCcsICdSZXN0YXJ0JywgJ1BhdXNlJywgJ1Jlc3VtZScpDQogICAgICAgIGlmICgoJHNlcnZpY2VzU3RhcnRUeXBlTGlzdFskaV0gLWVxICJEaXNhYmxlZCIpIC1hbmQgKCRhY3RpdmVTdGF0dXNlcyAtY29udGFpbnMgJHNlcnZpY2VzU3RhdHVzTGlzdFskaV0pKSB7DQogICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCRzZXJ2aWNlUHJvcGVydHlMaXN0WyRpXS5TdGF0dXMgLW5lICRzZXJ2aWNlc1N0YXR1c0xpc3RbJGldKSB7DQogICAgICAgICAgICBzd2l0Y2ggKCRzZXJ2aWNlc1N0YXR1c0xpc3RbJGldKSB7DQogICAgICAgICAgICAgICAgIlN0YXJ0IiB7DQogICAgICAgICAgICAgICAgICAgIFN0YXJ0LVNlcnZpY2VIZWxwZXIgJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldOyBicmVhaw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAiU3RvcCIgew0KICAgICAgICAgICAgICAgICAgICBTdG9wLVNlcnZpY2VIZWxwZXIgJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldOyBicmVhaw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAiUmVzdGFydCIgew0KICAgICAgICAgICAgICAgICAgICBSZXN0YXJ0LVNlcnZpY2VIZWxwZXIgJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldOyBicmVhaw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAiUGF1c2UiIHsNCiAgICAgICAgICAgICAgICAgICAgU3VzcGVuZC1TZXJ2aWNlSGVscGVyICRzZXJ2aWNlUHJvcGVydHlMaXN0WyRpXTsgYnJlYWsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgIlJlc3VtZSIgew0KICAgICAgICAgICAgICAgICAgICBSZXN1bWUtU2VydmljZUhlbHBlciAkc2VydmljZVByb3BlcnR5TGlzdFskaV07IGJyZWFrDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGRlZmF1bHQgew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gR2V0LURlbGF5ZWRTZXJ2aWNlIHsNCiAgICAjIFJlZ2lzdHJ5IGtleSBEZWxheWVkQXV0b1N0YXJ0ID0gMSBmb3IgZGVsYXllZCBzZXJ2aWNlcyBvbmx5DQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdTaWxlbnRseUNvbnRpbnVlJw0KICAgICRkZWxheWVkU2VydmljZXMgPSBHZXQtSXRlbVByb3BlcnR5IEhLTE06XFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxzZXJ2aWNlc1wqIHwgV2hlcmUtT2JqZWN0IHsgJF8uRGVsYXllZEF1dG9TdGFydCAtZXEgMSB9DQogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdTdG9wJw0KICAgICRkZWxheWVkU2VydmljZXMgPSAkZGVsYXllZFNlcnZpY2VzIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgUFNDaGlsZE5hbWUNCiAgICAkZGVsYXllZFNlcnZpY2VzDQp9DQoNCmZ1bmN0aW9uIFRlc3QtVHJpZ2dlclN0YXJ0U2VydmljZSAoW3N0cmluZ10kc2VydmljZU5hbWUpIHsNCg0KICAgIGlmIChUZXN0LVBhdGggLVBhdGggIkhLTE06XFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxTZXJ2aWNlc1wkc2VydmljZU5hbWVcVHJpZ2dlckluZm8iKSB7DQogICAgICAgIHJldHVybiAkdHJ1ZQ0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAkZmFsc2UNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIENvbXBhcmUtU2VydmljZVN0YXR1cyAoW3Bzb2JqZWN0W11dJHNlcnZpY2VQcm9wZXJ0eUxpc3QsIFtwc29iamVjdFtdXSRjdXJyZW50U2VydmljZVByb3BlcnR5TGlzdCwgJHNlcnZpY2VzU3RhdHVzTGlzdCkgew0KDQogICAgJGNvbXBhcmVTZXJ2aWNlU3RhdHVzTGlzdCA9IEAoKQ0KICAgICRhY3RpdmVTdGF0dXNlcyA9IEAoJ1N0YXJ0JywgJ1Jlc3RhcnQnLCAnUGF1c2UnLCAnUmVzdW1lJykNCg0KICAgIGZvciAoJGkgPSAwOyAkaSAtbHQgJHNlcnZpY2VzU3RhdHVzTGlzdC5Db3VudDsgJGkrKykgew0KICAgICAgICAkY29tcGFyZVNlcnZpY2VTdGF0dXMgPSAnJw0KICAgICAgICAjIFNlcnZpY2UgY2Fubm90IGJlIGZvdW5kDQogICAgICAgIGlmICgkc2VydmljZVByb3BlcnR5TGlzdFskaV0uRGlzcGxheU5hbWUgLWVxICRudWxsKSB7DQogICAgICAgICAgICAkY29tcGFyZVNlcnZpY2VTdGF0dXMgKz0gIk5hbWU6ICQoJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldLk5hbWUpICROZXdMaW5lIg0KICAgICAgICAgICAgJGNvbXBhcmVTZXJ2aWNlU3RhdHVzICs9ICJTZXJ2aWNlIGNhbm5vdCBiZSBmb3VuZC4gJE5ld0xpbmUiDQogICAgICAgIH0NCiAgICAgICAgIyBTZXJ2aWNlIGNhbm5vdCBiZSAnRGlzYWJsZWQnIGFuZCBoYXMgYW55IGFjdGl2ZSBzdGF0dXMgYXQgdGhlIHNhbWUgdGltZQ0KICAgICAgICBlbHNlaWYgKCgkY3VycmVudFNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldLlN0YXJ0VHlwZSAtZXEgIkRpc2FibGVkIikgLWFuZCAoJGFjdGl2ZVN0YXR1c2VzIC1jb250YWlucyAkc2VydmljZXNTdGF0dXNMaXN0WyRpXSkpIHsNCiAgICAgICAgICAgICRjb21wYXJlU2VydmljZVN0YXR1cyArPSAiTmFtZTogJCgkc2VydmljZVByb3BlcnR5TGlzdFskaV0uTmFtZSkgJE5ld0xpbmUiDQogICAgICAgICAgICAkY29tcGFyZVNlcnZpY2VTdGF0dXMgKz0gIlN0YXR1cyBjb3VsZCBub3QgYmUgY2hhbmdlZCBiZWNhdXNlIHNlcnZpY2UgaXMgJ0Rpc2FibGVkJy4gJE5ld0xpbmUiDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkY29tcGFyZVNlcnZpY2VTdGF0dXMgKz0gIk5hbWU6ICQoJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldLk5hbWUpICROZXdMaW5lIg0KICAgICAgICAgICAgJGNvbXBhcmVTZXJ2aWNlU3RhdHVzICs9ICJQcmV2aW91cyBzdGF0dXM6ICQoJHNlcnZpY2VQcm9wZXJ0eUxpc3RbJGldLlN0YXR1cykgJE5ld0xpbmUiDQogICAgICAgICAgICAkY29tcGFyZVNlcnZpY2VTdGF0dXMgKz0gIkN1cnJlbnQgc3RhdHVzOiAkKCRjdXJyZW50U2VydmljZVByb3BlcnR5TGlzdFskaV0uU3RhdHVzKSAkTmV3TGluZSINCiAgICAgICAgICAgICRjb21wYXJlU2VydmljZVN0YXR1cyArPSAiUHJldmlvdXMgc3RhcnQgdHlwZTogJCgkc2VydmljZVByb3BlcnR5TGlzdFskaV0uU3RhcnRUeXBlKSAkTmV3TGluZSINCiAgICAgICAgICAgICRjb21wYXJlU2VydmljZVN0YXR1cyArPSAiQ3VycmVudCBzdGFydCB0eXBlOiAkKCRjdXJyZW50U2VydmljZVByb3BlcnR5TGlzdFskaV0uU3RhcnRUeXBlKSAkTmV3TGluZSINCg0KICAgICAgICB9DQogICAgICAgICRjb21wYXJlU2VydmljZVN0YXR1c0xpc3QgKz0gJGNvbXBhcmVTZXJ2aWNlU3RhdHVzDQoNCiAgICAgICAgaWYgKCRzZXJ2aWNlc1N0YXR1c0xpc3QuQ291bnQgLWd0IDEgLWFuZCAkaSAtbHQgKCRzZXJ2aWNlc1N0YXR1c0xpc3QuQ291bnQgLSAxKSkgew0KICAgICAgICAgICAgJGNvbXBhcmVTZXJ2aWNlU3RhdHVzTGlzdCArPSAkTmV3TGluZQ0KDQogICAgICAgIH0NCiAgICB9DQogICAgJGNvbXBhcmVTZXJ2aWNlU3RhdHVzTGlzdA0KfQ0KDQojDQojIE1haW4gc2NyaXB0IGZsb3cNCiMNCkFkZC1UeXBlIC1QYXRoICRlbnY6TkVYVEhJTktcUmVtb3RlQWN0aW9uc1xueHRyZW1vdGVhY3Rpb25zLmRsbA0KDQp0cmFwIHsNCiAgICAkaG9zdC51aS5Xcml0ZUVycm9yTGluZSgkXy5Ub1N0cmluZygpKQ0KICAgIFtFbnZpcm9ubWVudF06OkV4aXQoMSkNCn0NCg0KaWYgKC1ub3QgJChhc19sb2NhbF9zeXN0ZW0pKSB7DQogICAgdGhyb3cgIlRoaXMgc2NyaXB0IG11c3QgYmUgcnVuIGFzIExvY2FsU3lzdGVtLiAiDQp9DQoNCltzdHJpbmdbXV0kc2VydmljZU5hbWVMaXN0ID0gU3BsaXQtU3RyaW5nQXJndW1lbnQgJFNlcnZpY2VOYW1lDQpbc3RyaW5nW11dJHNlcnZpY2VzU3RhdHVzTGlzdCA9IFNwbGl0LVN0cmluZ0FyZ3VtZW50ICRTdGF0dXNDaGFuZ2UNCltzdHJpbmdbXV0kc2VydmljZXNTdGFydFR5cGVMaXN0ID0gU3BsaXQtU3RyaW5nQXJndW1lbnQgJFNldFN0YXJ0VHlwZVRvDQoNClRlc3QtUGFyYW1ldGVycyAkc2VydmljZU5hbWVMaXN0ICRzZXJ2aWNlc1N0YXR1c0xpc3QgJHNlcnZpY2VzU3RhcnRUeXBlTGlzdA0KDQpbcHNvYmplY3RbXV0kc2VydmljZVByb3BlcnR5TGlzdCA9IEdldC1TZXJ2aWNlUHJvcGVydHkgJHNlcnZpY2VOYW1lTGlzdA0KDQpTZXQtU2VydmljZVN0YXJ0VHlwZSAkc2VydmljZVByb3BlcnR5TGlzdCAkc2VydmljZXNTdGFydFR5cGVMaXN0DQpTZXQtU2VydmljZVN0YXR1cyAkc2VydmljZVByb3BlcnR5TGlzdCAkc2VydmljZXNTdGF0dXNMaXN0ICRzZXJ2aWNlc1N0YXJ0VHlwZUxpc3QNCg0KW3Bzb2JqZWN0W11dJGN1cnJlbnRTZXJ2aWNlUHJvcGVydHlMaXN0ID0gR2V0LVNlcnZpY2VQcm9wZXJ0eSAkc2VydmljZU5hbWVMaXN0DQpbc3RyaW5nW11dJGNvbXBhcmVTZXJ2aWNlU3RhdHVzTGlzdCA9IENvbXBhcmUtU2VydmljZVN0YXR1cyAkc2VydmljZVByb3BlcnR5TGlzdCAkY3VycmVudFNlcnZpY2VQcm9wZXJ0eUxpc3QgJHNlcnZpY2VzU3RhdHVzTGlzdA0KDQpbTnh0XTo6V3JpdGVPdXRwdXRTdHJpbmdMaXN0KCJVcGRhdGVkU2VydmljZVN0YXR1cyIsICRjb21wYXJlU2VydmljZVN0YXR1c0xpc3QpDQo="}}}