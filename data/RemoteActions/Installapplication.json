{"id": "Install_application_windows", "name": "Install application", "description": ". Install applications using either the Microsoft Software Installer (MSI) or a custom installer. \nThe Remote Action includes protection layers to provide secure installation method.  That includes verification of the hash of the installer to be used or including the hash of the root CA of the installer within the remote action code. \n\n'''''Warning:''' This Remote Action starts the simultaneous download of the desired installation packages on all targeted devices", "purpose": ["REMEDIATION"], "targeting": {"apiEnabled": true, "manualEnabled": true, "manualAllowMultipleDevices": false}, "scriptInfo": {"runAs": "LOCAL_SYSTEM", "timeoutSeconds": 720, "inputs": [{"description": "Maximum random delay set to avoid network overload. Provide number of seconds lower than 600", "id": "MaximumDelayInSeconds", "name": "MaximumDelayInSeconds", "options": ["30"], "allowCustomValue": false, "usedByWindows": true, "usedByMacOs": false}, {"description": "Provide URL or UNC path to retrieve the installer file. Example values: http(s)://domain/folder/installer.exe, \\\\server\\SharedFolder\\winrar-x64-571.exe", "id": "InstallerSource", "name": "InstallerSource", "options": ["''"], "allowCustomValue": false, "usedByWindows": true, "usedByMacOs": false}, {"description": "Provide expected file hash using SHA256 algorithm to verify delivered installer file. E.g. FD820BF82EDBAA4BE20FD3B644A05754D95D71DE60FE79AB983C3318E0697540", "id": "InstallerHash", "name": "InstallerHash", "options": ["''"], "allowCustomValue": false, "usedByWindows": true, "usedByMacOs": false}, {"description": "Provide optional arguments for the installer (either for .MSI or .EXE). Common parameter prefix and letters or numbers are allowed, such as /quiet, /noreboot, /s, /1, etc. Provide \"\" if no arguments are needed", "id": "InstallParameters", "name": "InstallParameters", "options": ["''"], "allowCustomValue": false, "usedByWindows": true, "usedByMacOs": false}], "outputs": [], "scriptWindows": {"name": "Install-Application.ps1", "script": "77u/PCMNCi5TWU5PUFNJUw0KUnVucyB0aGUgcHJvdmlkZWQgV2luZG93cyBpbnN0YWxsZXIgd2l0aCB0aGUgcHJvdmlkZWQgYXJndW1lbnRzLg0KDQouREVTQ1JJUFRJT04NCkluc3RhbGwgYXBwbGljYXRpb25zIHVzaW5nIGVpdGhlciB0aGUgTWljcm9zb2Z0IFNvZnR3YXJlIEluc3RhbGxlciAoTVNJKSBvciBhIGN1c3RvbSBpbnN0YWxsZXIuDQpUaGUgUmVtb3RlIEFjdGlvbiBpbmNsdWRlcyBwcm90ZWN0aW9uIGxheWVycyB0byBwcm92aWRlIHNlY3VyZSBpbnN0YWxsYXRpb24gbWV0aG9kLiBUaGF0IGluY2x1ZGVzIHZlcmlmaWNhdGlvbiBvZiB0aGUgaGFzaCBvZiB0aGUgaW5zdGFsbGVyIHRvIGJlIHVzZWQgb3IgaW5jbHVkaW5nIHRoZSBoYXNoIG9mIHRoZSByb290IENBIG9mIHRoZSBpbnN0YWxsZXIgd2l0aGluIHRoZSByZW1vdGUgYWN0aW9uIGNvZGUuDQoNCicnJycnV2FybmluZzonJycgVGhpcyBSZW1vdGUgQWN0aW9uIHN0YXJ0cyB0aGUgc2ltdWx0YW5lb3VzIGRvd25sb2FkIG9mIHRoZSBkZXNpcmVkIGluc3RhbGxhdGlvbiBwYWNrYWdlcyBvbiBhbGwgdGFyZ2V0ZWQgZGV2aWNlcy4gUGxlYXNlIGVuc3VyZSB0aGF0IHRoZSBhdmFpbGFibGUgbmV0d29yayBjYXBhY2l0eSBpcyBhcHByb3ByaWF0ZSBmb3IgdGhlIG51bWJlciBvZiB0YXJnZXRlZCBkZXZpY2VzLicnDQoNCi5GVU5DVElPTkFMSVRZDQpSZW1lZGlhdGlvbg0KDQouSU5QVVRTDQpJRCAgTGFiZWwgICAgICAgICAgICAgICAgICAgICAgICAgICBEZXNjcmlwdGlvbg0KMSAgIE1heGltdW1EZWxheUluU2Vjb25kcyAgICAgICAgICAgTWF4aW11bSByYW5kb20gZGVsYXkgc2V0IHRvIGF2b2lkIG5ldHdvcmsgb3ZlcmxvYWQuIFByb3ZpZGUgbnVtYmVyIG9mIHNlY29uZHMgbG93ZXIgdGhhbiA2MDANCjIgICBJbnN0YWxsZXJTb3VyY2UgICAgICAgICAgICAgICAgIFByb3ZpZGUgVVJMIG9yIFVOQyBwYXRoIHRvIHJldHJpZXZlIHRoZSBpbnN0YWxsZXIgZmlsZS4gRXhhbXBsZSB2YWx1ZXM6IGh0dHAocyk6Ly9kb21haW4vZm9sZGVyL2luc3RhbGxlci5leGUsIFxcc2VydmVyXFNoYXJlZEZvbGRlclx3aW5yYXIteDY0LTU3MS5leGUNCjMgICBJbnN0YWxsZXJIYXNoICAgICAgICAgICAgICAgICAgIFByb3ZpZGUgZXhwZWN0ZWQgZmlsZSBoYXNoIHVzaW5nIFNIQTI1NiBhbGdvcml0aG0gdG8gdmVyaWZ5IGRlbGl2ZXJlZCBpbnN0YWxsZXIgZmlsZS4gRS5nLiBGRDgyMEJGODJFREJBQTRCRTIwRkQzQjY0NEEwNTc1NEQ5NUQ3MURFNjBGRTc5QUI5ODNDMzMxOEUwNjk3NTQwDQo0ICAgSW5zdGFsbFBhcmFtZXRlcnMgICAgICAgICAgICAgICBQcm92aWRlIG9wdGlvbmFsIGFyZ3VtZW50cyBmb3IgdGhlIGluc3RhbGxlciAoZWl0aGVyIGZvciAuTVNJIG9yIC5FWEUpLiBDb21tb24gcGFyYW1ldGVyIHByZWZpeCBhbmQgbGV0dGVycyBvciBudW1iZXJzIGFyZSBhbGxvd2VkLCBzdWNoIGFzIC9xdWlldCwgL25vcmVib290LCAvcywgLzEsIGV0Yy4gUHJvdmlkZSAiIiBpZiBubyBhcmd1bWVudHMgYXJlIG5lZWRlZA0KDQouRlVSVEhFUiBJTkZPUk1BVElPTg0KVGhlIGluc3RhbGxlciBwYXRoIGNvdWxkIGJlIGVpdGhlciBhbiBVTkMgcGF0aCB3aXRoIHJlYWQgYWNjZXNzIG9yIGFuIFVSTC4gVGhlIE1TSSBlcnJvciBjb2RlcyBhcmUgZG9jdW1lbnRlZCBbaHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvd2luZG93cy9kZXNrdG9wL01zaS9lcnJvci1jb2RlcyBoZXJlXS4NCklmIHRoZSBhcHBsaWNhdGlvbiBpcyBhbHJlYWR5IGluc3RhbGxlZCwgaXQgbWlnaHQgYmUgcmUtaW5zdGFsbGVkLiBVc2VyIHNldHRpbmdzIG9yIGFwcGxpY2F0aW9uIGRhdGEgbWF5IGJlIGxvc3QuDQpJZiB0YXJnZXRpbmcgYSBub24tTVNJLWJhc2VkIGFwcGxpY2F0aW9uLCBpdCBpcyBmcmVxdWVudGx5IG5lY2Vzc2FyeSB0byBzcGVjaWZ5IGFkZGl0aW9uYWwgcGFyYW1ldGVycyBmb3IgYSBzaWxlbnQgaW5zdGFsbC4gUGxlYXNlIHZpc2l0IG9mZmljaWFsIGRvY3VtZW50YXRpb24gZnJvbSB0aGUgYXBwbGljYXRpb24gdmVuZG9yLg0KQmUgYXdhcmUgb2Ygd2hldGhlciBzaWxlbnQgaW5zdGFsbCBwYXJhbWV0ZXJzIGFyZSBvbWl0dGVkLCB0aGUgaW5zdGFsbCBwcm9jZXNzIG1heSBiZSB3YWl0aW5nIGZvcmV2ZXIgZm9yIHVzZXIgYWN0aW9uIHdoaWxlIHRoZSByZW1vdGUgYWN0aW9uIHRlcm1pbmF0ZWQgYmVmb3JlIGNvbXBsZXRpb24uIEluIHN1Y2ggY2FzZSwgeW91IG5lZWQgdG8ga2lsbCB0aGUgcHJvY2VzcyBiZWZvcmUgZXhlY3V0aW5nIHRoZSByZW1vdGUgYWN0aW9uIGFnYWluLg0KVG8gdW5kZXJzdGFuZCBob3cgdG8gY29uZmlndXJlIGEgbmV0d29yayBzaGFyZSB0byB3b3JrIHByb3Blcmx5IHdpdGggTmV4dGhpbmsgQWN0LCBwbGVhc2UgdmlzaXQgdGhpcyBbaHR0cHM6Ly9jb21tdW5pdHkubmV4dGhpbmsuY29tL3MvYXJ0aWNsZS8zNjAwMDQ1NTQxODAtQ29ycmVjdGx5LXVzZS1zaGFyZWQtZm9sZGVycy13aXRoLU5leHRoaW5rLUFjdCBwYWdlXS4NClRvIGdldCB0aGUgaW5zdGFsbGVyIGhhc2gsIHR5cGUgdGhpcyBjb21tYW5kIG9uIGEgV2luZG93cyAxMCBQb3dlclNoZWxsIHNlc3Npb24iOiIgR2V0LUZpbGVIYXNoIC1QYXRoIDxQQVRIX1RPX1RIRV9GSUxFPiAtQWxnb3JpdGhtIFNIQTI1Ni4NCg0KSWYgYSBpbnN0YWxsZXIgaGFzaCBpcyBub3QgcHJvdmlkZWQsIHRoZSBoYXNoIG9mIHRoZSByb290IENBIG11c3QgYmUgaW5jbHVkZWQgd2l0aGluIHRoZSByZW1vdGUgYWN0aW9uIGNvZGUuIEl0IG11c3QgYmUgcG9wdWxhdGVkIGFzIGFuIGFkZGl0aW9uYWwgbGluZSBvbiBUUlVTVEVEX1BVQkxJQ19DQVMgdmFyaWFibGU6DQogICAgWy4uLl0nN0FGMkQ4RkY5QTNFREFDOTlDQTNBRTdGOEZCNENDQUJCMTIwQzFFMjkyQkUwNTY1QTY3QzZGNUI0MTdBMUFEMScgPSAnQWRvYmUgQWNyb2JhdCBEQyBBZG9iZSBJbmMnDQogICAgJ1hYWFhYWEhBU0hGUk9NVEhFUk9PVENBRlJPTVRIRUlOU1RBTExFUk1VU1RCRUlOQ0xVREVESEVSRVhYWFhYWFgnID0gJ05hbWUgb2YgdGhlIHNvdXJjZSd9Wy4uLl0NCg0KVG8gb2J0YWluIHRoZSBoYXNoIG9mIHRoZSByb290IGNhIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb24gY2FuIGJlIHVzZWQ6DQoNCiAgICBmdW5jdGlvbiBHZXQtUm9vdENBU2lnbmF0dXJlKFtzdHJpbmddJEV4ZWN1dGFibGVQYXRoKSB7DQogICAgICAgICRjaGFpbiA9IE5ldy1PYmplY3QgLVR5cGVOYW1lICdzZWN1cml0eS5jcnlwdG9ncmFwaHkueDUwOWNlcnRpZmljYXRlcy54NTA5Y2hhaW4nDQogICAgICAgICRjaGFpbi5CdWlsZCgoR2V0LUF1dGhlbnRpY29kZVNpZ25hdHVyZSAtRmlsZVBhdGggJEV4ZWN1dGFibGVQYXRoKS5TaWduZXJDZXJ0aWZpY2F0ZSkNCiAgICAgICAgJHJvb3RDYSA9ICRjaGFpbi5DaGFpbkVsZW1lbnRzIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgQ2VydGlmaWNhdGUgLUxhc3QgMQ0KICAgICAgICAkcHVibGljS2V5ID0gW3N5c3RlbS50ZXh0LmVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkcm9vdENhLkdldFB1YmxpY0tleVN0cmluZygpKQ0KICAgICAgICAkaGFzaCA9IFtzZWN1cml0eS5jcnlwdG9ncmFwaHkuaGFzaGFsZ29yaXRobV06OkNyZWF0ZSgnU0hBMjU2JykuQ29tcHV0ZUhhc2goJHB1YmxpY0tleSkNCiAgICAgICAgcmV0dXJuIFtiaXRjb252ZXJ0ZXJdOjpUb1N0cmluZygkaGFzaCkgLXJlcGxhY2UgJy0nLCAnJw0KICAgIH0NCg0KVGhlbiwgcnVuIHRoZSBmb2xsb3dpbmcgY29tbWFuZDogIkdldC1Sb290Q0FTaWduYXR1cmUgLUV4ZWN1dGFibGVQYXRoICdDOlxUZW1wXGV4ZWN1dGFibGUuZXhlJyIuDQoNCi5SRVNUUklDVElPTlMNCi0gVGhpcyBzY3JpcHQgaXMgbm90IHNpZ25lZCBieSBOZXh0aGluayBkdWUgdG8gc2VjdXJpdHkgY29uY2VybnMuDQoNCi5OT1RFUw0KQ29udGV4dDogICAgICAgICAgICBMb2NhbFN5c3RlbQ0KVmVyc2lvbjogICAgICAgICAgICAzLjAuMS4yIC0gVXBkYXRlZCB0byBmaXggZGVsaXZlcnkgaXNzdWVzDQogICAgICAgICAgICAgICAgICAgIDMuMC4xLjEgLSBGaXhlZCB0eXBvIGluIFRlc3QtTWluaW11bVdpbmRvd3NWZXJzaW9uDQogICAgICAgICAgICAgICAgICAgIDMuMC4xLjAgLSBGaXhlZCBpc3N1ZSB3aXRoIGhhc2ggdmFsaWRhdGlvbg0KICAgICAgICAgICAgICAgICAgICAzLjAuMC4wIC0gUmVtb3ZlZCByZWR1bmRhbnQgaW5wdXQgcGFyYW1ldGVyIGFuZCBpbXByb3ZlZCBpbnN0YWxsZXIgdmVyaWZpY2F0aW9uIHByb2Nlc3MNCiAgICAgICAgICAgICAgICAgICAgMi4zLjAuMCAtIFVwZGF0ZWQgZGVzY3JpcHRpb24NCiAgICAgICAgICAgICAgICAgICAgMi4yLjAuMCAtIEltcHJvdmVkIHNlY3VyaXR5IGFzcGVjdHMNCiAgICAgICAgICAgICAgICAgICAgMi4xLjAuMCAtIEFkZGVkIHN1cHBvcnQgb2YgbW9yZSBhcmd1bWVudCBmb3JtYXRzLiBBZGRlZCBzdXBwb3J0IG9mIE1TSSBhcmd1bWVudHMuIE1hZGUgc2VjdXJpdHkgdmVyaWZpY2F0aW9ucyBvcHRpb25hbA0KICAgICAgICAgICAgICAgICAgICAyLjAuMS4wIC0gRG9jdW1lbnRhdGlvbiBsaW5rIHVwZGF0ZWQNCiAgICAgICAgICAgICAgICAgICAgMi4wLjAuMCAtIEFsbG93IGN1c3RvbSBpbnN0YWxsZXJzIGFuZCBzb3VyY2VzIGZyb20gVVJMcw0KICAgICAgICAgICAgICAgICAgICAxLjAuMC4xIC0gVXBkYXRlZCBkb2N1bWVudGF0aW9uIGFuZCBpbmRlbnRhdGlvbg0KICAgICAgICAgICAgICAgICAgICAxLjAuMC4wIC0gSW5pdGlhbCByZWxlYXNlDQpMYXN0IEdlbmVyYXRlZDogICAgIDI4IEFwciAyMDIyIC0gMDg6NTQ6MjYNCkNvcHlyaWdodCAoQykgMjAyMiBOZXh0aGluayBTQSwgU3dpdHplcmxhbmQNCiM+DQojDQojIElucHV0IHBhcmFtZXRlcnMgZGVmaW5pdGlvbg0KIw0KcGFyYW0oDQogICAgW1BhcmFtZXRlcihNYW5kYXRvcnkgPSAkdHJ1ZSldW3N0cmluZ10kTWF4aW11bURlbGF5SW5TZWNvbmRzLA0KICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXVtzdHJpbmddJEluc3RhbGxlclNvdXJjZSwNCiAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV1bc3RyaW5nXSRJbnN0YWxsZXJIYXNoLA0KICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXVtzdHJpbmddJEluc3RhbGxQYXJhbWV0ZXJzDQopDQojIEVuZCBvZiBwYXJhbWV0ZXJzIGRlZmluaXRpb24NCg0KJGVudjpQYXRoID0gIiRlbnY6U3lzdGVtUm9vdFxzeXN0ZW0zMjskZW52OlN5c3RlbVJvb3Q7JGVudjpTeXN0ZW1Sb290XFN5c3RlbTMyXFdiZW07JGVudjpTeXN0ZW1Sb290XFN5c3RlbTMyXFdpbmRvd3NQb3dlclNoZWxsXHYxLjBcIg0KDQojDQojIENvbnN0YW50cyBkZWZpbml0aW9uDQojDQpOZXctVmFyaWFibGUgLU5hbWUgJ0NNRF9FWEUnIGANCiAgICAtVmFsdWUgIiRlbnY6U3lzdGVtUm9vdFxTeXN0ZW0zMlxjbWQuZXhlIiBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0DQpOZXctVmFyaWFibGUgLU5hbWUgJ0VSUk9SX0VYQ0VQVElPTl9UWVBFJyBgDQogICAgLVZhbHVlIEB7RW52aXJvbm1lbnQgPSAnW0Vudmlyb25tZW50IGVycm9yXScNCiAgICAgICAgICAgICBJbnB1dCA9ICdbSW5wdXQgZXJyb3JdJw0KICAgICAgICAgICAgIEludGVybmFsID0gJ1tJbnRlcm5hbCBlcnJvcl0nfSBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0DQpOZXctVmFyaWFibGUgLU5hbWUgJ0xPQ0FMX1NZU1RFTV9JREVOVElUWScgYA0KICAgIC1WYWx1ZSAnUy0xLTUtMTgnIC1PcHRpb24gUmVhZE9ubHkgLVNjb3BlIFNjcmlwdA0KTmV3LVZhcmlhYmxlIC1OYW1lICdNQVhfU0NSSVBUX0RFTEFZX1NFQycgYA0KICAgIC1WYWx1ZSA2MDAgYA0KICAgIC1PcHRpb24gUmVhZE9ubHkgLVNjb3BlIFNjcmlwdA0KTmV3LVZhcmlhYmxlIC1OYW1lICdORVRXT1JLX01BTkFHRVJfQ0xTSUQnIGANCiAgICAtVmFsdWUgKFtndWlkXSd7RENCMDBDMDEtNTcwRi00QTlCLThENjktMTk5RkRCQTU3MjNCfScpIGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQNCk5ldy1WYXJpYWJsZSAtTmFtZSAnVFJVU1RFRF9QVUJMSUNfQ0FTJyBgDQogICAgLVZhbHVlIEB7JzZBQjg3QjU1QUQwMzdBMjRDMDc0NEZGMTA0QzEwQ0VEQTJCNDhDQ0ZCNUZFQjA4NjQwQkRDRjg3NEM5MjMxRUQnID0gJ01pY3Jvc29mdCBDb3Jwb3JhdGlvbiBSb290IENBJw0KICAgICAgICAgICAgICc0NTRCMENEMkMyMDc1MUVEM0QxMDU2MTYzRkU3MkU5MTEzQzk2NzVEMzQ2Qjk0NjczOUYwQUY4RUQzNzFGQjM5JyA9ICdNaWNyb3NvZnQgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHknDQogICAgICAgICAgICAgJzc5NjU0RDkwQzNBNEE5QUEyMjAyNURCQ0M4QzI4RjJFQTU4RUJEQjI1RTE1OUREQzI2MTAxNDNCQjdGN0RBRDYnID0gJ01pY3Jvc29mdCBSb290IENlcnRpZmljYXRlIEF1dGhvcml0eSAyMDEwJw0KICAgICAgICAgICAgICc3QUYyRDhGRjlBM0VEQUM5OUNBM0FFN0Y4RkI0Q0NBQkIxMjBDMUUyOTJCRTA1NjVBNjdDNkY1QjQxN0ExQUQxJyA9ICdBZG9iZSBBY3JvYmF0IERDIEFkb2JlIEluYyd9IGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQNCk5ldy1WYXJpYWJsZSAtTmFtZSAnVU5CTE9DS19DT01NQU5EJyBgDQogICAgLVZhbHVlICcvQyBlY2hvLj4iezB9Ijpab25lLklkZW50aWZpZXInIGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQNCk5ldy1WYXJpYWJsZSAtTmFtZSAnV0lORE9XU19WRVJTSU9OUycgYA0KICAgIC1WYWx1ZSBAe1dpbmRvd3M3ID0gJzYuMScNCiAgICAgICAgICAgICBXaW5kb3dzOCA9ICc2LjInDQogICAgICAgICAgICAgV2luZG93czgxID0gJzYuMycNCiAgICAgICAgICAgICBXaW5kb3dzMTAgPSAnMTAuMCcNCiAgICAgICAgICAgICBXaW5kb3dzMTEgPSAnMTAuMCd9IGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQNCg0KTmV3LVZhcmlhYmxlIC1OYW1lICdDVVNUT01fSU5TVEFMTEVSX1RFTVBfRklMRV9OQU1FJyBgDQogICAgLVZhbHVlICdpbnN0YWxsZXIuZXhlJyBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0IC1Gb3JjZQ0KDQpOZXctVmFyaWFibGUgLU5hbWUgJ01TSV9JTlNUQUxMRVJfUEFUSCcgYA0KICAgIC1WYWx1ZSAiJGVudjpTeXN0ZW1Sb290XHN5c3RlbTMyXG1zaWV4ZWMuZXhlIiBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0IC1Gb3JjZQ0KTmV3LVZhcmlhYmxlIC1OYW1lICdNU0lfSU5TVEFMTEVSX1RFTVBfRklMRV9OQU1FJyBgDQogICAgLVZhbHVlICJpbnN0YWxsZXIubXNpIiBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0IC1Gb3JjZQ0KTmV3LVZhcmlhYmxlIC1OYW1lICdNU0lfSU5TVEFMTEVSX0lOU1RBTExfT1BUSU9OJyBgDQogICAgLVZhbHVlICcvaScgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0IC1Gb3JjZQ0KTmV3LVZhcmlhYmxlIC1OYW1lICdNU0lfSU5TVEFMTEVSX1FVSUVUX09QVElPTicgYA0KICAgIC1WYWx1ZSAnL3FuJyBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0IC1Gb3JjZQ0KTmV3LVZhcmlhYmxlIC1OYW1lICdNU0lfSU5TVEFMTEVSX05PX1JFQk9PVF9PUFRJT04nIGANCiAgICAtVmFsdWUgJy9ub3Jlc3RhcnQnIGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQgLUZvcmNlDQpOZXctVmFyaWFibGUgLU5hbWUgJ01TSV9JTlNUQUxMRVJfU1VQUFJFU1NfUkVCT09UX09QVElPTicgYA0KICAgIC1WYWx1ZSAnUmVib290PSJSZWFsbHlTdXBwcmVzcyInIGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQgLUZvcmNlDQoNCk5ldy1WYXJpYWJsZSAtTmFtZSAnTVNJX0lOU1RBTExFUl9TVUNDRVNTJyBgDQogICAgLVZhbHVlIDAgYA0KICAgIC1PcHRpb24gUmVhZE9ubHkgLVNjb3BlIFNjcmlwdCAtRm9yY2UNCk5ldy1WYXJpYWJsZSAtTmFtZSAnTVNJX0lOU1RBTExFUl9TVUNDRVNTX1JFQk9PVF9JTklUSUFURUQnIGANCiAgICAtVmFsdWUgMTY0MSBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0IC1Gb3JjZQ0KTmV3LVZhcmlhYmxlIC1OYW1lICdNU0lfSU5TVEFMTEVSX1NVQ0NFU1NfUkVCT09UX1JFUVVJUkVEJyBgDQogICAgLVZhbHVlIDMwMTAgYA0KICAgIC1PcHRpb24gUmVhZE9ubHkgLVNjb3BlIFNjcmlwdCAtRm9yY2UNCg0KIw0KIyBJbnZva2UgTWFpbg0KIw0KZnVuY3Rpb24gSW52b2tlLU1haW4gKFtoYXNodGFibGVdJElucHV0UGFyYW1ldGVycykgew0KICAgICRleGl0Q29kZSA9IDANCiAgICB0cnkgew0KICAgICAgICBUZXN0LVJ1bm5pbmdBc0xvY2FsU3lzdGVtDQogICAgICAgIFRlc3QtTWluaW11bVN1cHBvcnRlZE9TVmVyc2lvbiAtV2luZG93c1ZlcnNpb24gJ1dpbmRvd3M3Jw0KICAgICAgICBUZXN0LUlucHV0UGFyYW1ldGVycyAtSW5wdXRQYXJhbWV0ZXJzICRJbnB1dFBhcmFtZXRlcnMNCg0KICAgICAgICAkaW5zdGFsbGVySW5mb3JtYXRpb24gPSBJbml0aWFsaXplLUluc3RhbGxlckluZm9ybWF0aW9uIC1JbnB1dFBhcmFtZXRlcnMgJElucHV0UGFyYW1ldGVycw0KICAgICAgICBJbnN0YWxsLUFwcGxpY2F0aW9uT3JNc2kgLUluc3RhbGxlckluZm8gJGluc3RhbGxlckluZm9ybWF0aW9uDQogICAgfSBjYXRjaCB7DQogICAgICAgIFdyaXRlLVN0YXR1c01lc3NhZ2UgLU1lc3NhZ2UgJF8NCiAgICAgICAgJGV4aXRDb2RlID0gMQ0KICAgIH0NCg0KICAgIHJldHVybiAkZXhpdENvZGUNCn0NCg0KIw0KIyBUZW1wbGF0ZSBmdW5jdGlvbnMNCiMNCmZ1bmN0aW9uIFRlc3QtUnVubmluZ0FzTG9jYWxTeXN0ZW0gew0KICAgIGlmICgtbm90IChDb25maXJtLUN1cnJlbnRVc2VySXNMb2NhbFN5c3RlbSkpIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLkVudmlyb25tZW50KSBUaGlzIHNjcmlwdCBtdXN0IGJlIHJ1biBhcyBMb2NhbFN5c3RlbS4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gQ29uZmlybS1DdXJyZW50VXNlcklzTG9jYWxTeXN0ZW0gew0KICAgICRjdXJyZW50SWRlbnRpdHkgPSBHZXQtQ3VycmVudElkZW50aXR5DQogICAgcmV0dXJuICRjdXJyZW50SWRlbnRpdHkgLWVxICRMT0NBTF9TWVNURU1fSURFTlRJVFkNCn0NCg0KZnVuY3Rpb24gR2V0LUN1cnJlbnRJZGVudGl0eSB7DQogICAgcmV0dXJuIFtzZWN1cml0eS5wcmluY2lwYWwud2luZG93c2lkZW50aXR5XTo6R2V0Q3VycmVudCgpLlVzZXIuVG9TdHJpbmcoKQ0KfQ0KDQpmdW5jdGlvbiBUZXN0LU1pbmltdW1TdXBwb3J0ZWRPU1ZlcnNpb24gKFtzdHJpbmddJFdpbmRvd3NWZXJzaW9uLCBbc3dpdGNoXSRTdXBwb3J0ZWRXaW5kb3dzU2VydmVyKSB7DQogICAgJGN1cnJlbnRPU0luZm8gPSBHZXQtT1NWZXJzaW9uVHlwZQ0KICAgICRPU1ZlcnNpb24gPSAkY3VycmVudE9TSW5mby5WZXJzaW9uIC1hcyBbdmVyc2lvbl0NCg0KICAgICRzdXBwb3J0ZWRXaW5kb3dzID0gJFdJTkRPV1NfVkVSU0lPTlMuJFdpbmRvd3NWZXJzaW9uIC1hcyBbdmVyc2lvbl0NCg0KICAgIGlmICgtbm90ICgkY3VycmVudE9TSW5mbykpIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLkVudmlyb25tZW50KSBUaGlzIHNjcmlwdCBjb3VsZCBub3QgcmV0dXJuIE9TIHZlcnNpb24uICINCiAgICB9DQoNCiAgICBpZiAoICRTdXBwb3J0ZWRXaW5kb3dzU2VydmVyIC1lcSAkZmFsc2UgLWFuZCAkY3VycmVudE9TSW5mby5Qcm9kdWN0VHlwZSAtbmUgMSkgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuRW52aXJvbm1lbnQpIFRoaXMgc2NyaXB0IGlzIG5vdCBjb21wYXRpYmxlIHdpdGggV2luZG93cyBTZXJ2ZXJzLiAiDQogICAgfQ0KDQogICAgaWYgKCAkT1NWZXJzaW9uIC1sdCAkc3VwcG9ydGVkV2luZG93cykgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuRW52aXJvbm1lbnQpIFRoaXMgc2NyaXB0IGlzIGNvbXBhdGlibGUgd2l0aCAkV2luZG93c1ZlcnNpb24gYW5kIGxhdGVyIG9ubHkuICINCiAgICB9DQp9DQoNCmZ1bmN0aW9uIEdldC1PU1ZlcnNpb25UeXBlIHsNCiAgICByZXR1cm4gR2V0LVdpbmRvd3NNYW5hZ2VtZW50RGF0YSAtQ2xhc3MgV2luMzJfT3BlcmF0aW5nU3lzdGVtIHwgU2VsZWN0LU9iamVjdCAtUHJvcGVydHkgVmVyc2lvbixQcm9kdWN0VHlwZQ0KfQ0KDQpmdW5jdGlvbiBHZXQtV2luZG93c01hbmFnZW1lbnREYXRhIChbc3RyaW5nXSRDbGFzcywgW3N0cmluZ10kTmFtZXNwYWNlID0gJ3Jvb3QvY2ltdjInKSB7DQogICAgdHJ5IHsNCiAgICAgICAgJHF1ZXJ5ID0gW3dtaXNlYXJjaGVyXSAiU2VsZWN0ICogZnJvbSAkQ2xhc3MiDQogICAgICAgICRxdWVyeS5TY29wZS5QYXRoID0gIiROYW1lc3BhY2UiDQogICAgICAgICRxdWVyeS5HZXQoKQ0KICAgIH0gY2F0Y2ggew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuRW52aXJvbm1lbnQpIEVycm9yIGdldHRpbmcgQ0lNL1dNSSBpbmZvcm1hdGlvbi4gVmVyaWZ5IFdpbk1nbXQgc2VydmljZSBzdGF0dXMgYW5kIFdNSSByZXBvc2l0b3J5IGNvbnNpc3RlbmN5LiAiDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBXcml0ZS1TdGF0dXNNZXNzYWdlIChbcHNvYmplY3RdJE1lc3NhZ2UpIHsNCiAgICAkZXhjZXB0aW9uTWVzc2FnZSA9ICRNZXNzYWdlLlRvU3RyaW5nKCkNCg0KICAgIGlmICgkTWVzc2FnZS5JbnZvY2F0aW9uSW5mby5TY3JpcHRMaW5lTnVtYmVyKSB7DQogICAgICAgICR2ZXJzaW9uID0gR2V0LVNjcmlwdFZlcnNpb24NCiAgICAgICAgaWYgKC1ub3QgW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJHZlcnNpb24pKSB7DQogICAgICAgICAgICAkc2NyaXB0VmVyc2lvbiA9ICJWZXJzaW9uOiAkdmVyc2lvbi4gIg0KICAgICAgICB9DQoNCiAgICAgICAgJGVycm9yTWVzc2FnZUxpbmUgPSAkc2NyaXB0VmVyc2lvbiArICJMaW5lICckKCRNZXNzYWdlLkludm9jYXRpb25JbmZvLlNjcmlwdExpbmVOdW1iZXIpJzogIg0KICAgIH0NCg0KICAgICRob3N0LnVpLldyaXRlRXJyb3JMaW5lKCRlcnJvck1lc3NhZ2VMaW5lICsgJGV4Y2VwdGlvbk1lc3NhZ2UpDQp9DQoNCmZ1bmN0aW9uIEdldC1TY3JpcHRWZXJzaW9uIHsNCiAgICAkc2NyaXB0Q29udGVudCA9IEdldC1Db250ZW50ICRNeUludm9jYXRpb24uU2NyaXB0TmFtZSB8IE91dC1TdHJpbmcNCiAgICBpZiAoJHNjcmlwdENvbnRlbnQgLW5vdG1hdGNoICc8I1tcclxuXXsyfS5TWU5PUFNJU1teXCNcPl0qKC5OT1RFU1teXCNcPl0qKVwjPicpIHsgcmV0dXJuIH0NCg0KICAgICRoZWxwQmxvY2sgPSAkTWF0Y2hlc1sxXS5TcGxpdChbZW52aXJvbm1lbnRdOjpOZXdMaW5lKQ0KDQogICAgZm9yZWFjaCAoJGxpbmUgaW4gJGhlbHBCbG9jaykgew0KICAgICAgICBpZiAoJGxpbmUgLW1hdGNoICdWZXJzaW9uOicpIHsNCiAgICAgICAgICAgIHJldHVybiAkbGluZS5TcGxpdCgnOicpWzFdLlNwbGl0KCctJylbMF0uVHJpbSgpDQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIFRlc3QtUGFyYW1JbkFsbG93ZWRSYW5nZSAoW3N0cmluZ10kUGFyYW1OYW1lLCBbc3RyaW5nXSRQYXJhbVZhbHVlLCBbaW50XSRMb3dlckxpbWl0LCBbaW50XSRVcHBlckxpbWl0KSB7DQogICAgVGVzdC1QYXJhbUlzSW50ZWdlciAtUGFyYW1OYW1lICRQYXJhbU5hbWUgLVBhcmFtVmFsdWUgJFBhcmFtVmFsdWUNCiAgICAkaW50VmFsdWUgPSAkUGFyYW1WYWx1ZSAtYXMgW2ludF0NCiAgICBpZiAoJGludFZhbHVlIC1sdCAkTG93ZXJMaW1pdCAtb3IgJGludFZhbHVlIC1ndCAkVXBwZXJMaW1pdCkgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuSW5wdXQpIEVycm9yIGluIHBhcmFtZXRlciAnJFBhcmFtTmFtZScuIEl0IG11c3QgYmUgYmV0d2VlbiBbJExvd2VyTGltaXQsICRVcHBlckxpbWl0XS4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gVGVzdC1QYXJhbUlzSW50ZWdlciAoW3N0cmluZ10kUGFyYW1OYW1lLCBbc3RyaW5nXSRQYXJhbVZhbHVlKSB7DQogICAgJGludFZhbHVlID0gJFBhcmFtVmFsdWUgLWFzIFtpbnRdDQogICAgaWYgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRQYXJhbVZhbHVlKSAtb3IgJG51bGwgLWVxICRpbnRWYWx1ZSkgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuSW5wdXQpIEVycm9yIGluIHBhcmFtZXRlciAnJFBhcmFtTmFtZScuICckUGFyYW1WYWx1ZScgaXMgbm90IGFuIGludGVnZXIuICINCiAgICB9DQp9DQoNCmZ1bmN0aW9uIENvbmZpcm0tU3RyaW5nSXNOb3RFbXB0eSAoW3N0cmluZ10kVmFsdWUpIHsNCiAgICByZXR1cm4gLW5vdCBbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgoRm9ybWF0LVN0cmluZ1ZhbHVlIC1WYWx1ZSAkVmFsdWUpKQ0KfQ0KDQpmdW5jdGlvbiBGb3JtYXQtU3RyaW5nVmFsdWUgKFtzdHJpbmddJFZhbHVlKSB7DQogICAgcmV0dXJuICRWYWx1ZS5SZXBsYWNlKCciJywgJycpLlJlcGxhY2UoIiciLCAnJykuVHJpbSgpDQp9DQoNCmZ1bmN0aW9uIFRlc3QtU2hhMjU2UGFyYW1ldGVyIChbc3RyaW5nXSRQYXJhbU5hbWUsIFtzdHJpbmddJFBhcmFtVmFsdWUpIHsNCiAgICBpZiAoJFBhcmFtVmFsdWUgLW5vdG1hdGNoICJeW0EtRmEtZjAtOV17NjR9JCIpIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLklucHV0KSBFcnJvciBpbiBwYXJhbWV0ZXIgJyRQYXJhbU5hbWUnLiBJdCBpcyBub3QgYSB2YWxpZCBTSEEyNTYgaGFzaC4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gVGVzdC1QYXRoUmVhZGFibGUgKFtzdHJpbmddJFBhcmFtTmFtZSwgW3N0cmluZ10kUGFyYW1WYWx1ZSkgew0KICAgIGlmICgtbm90IChUZXN0LVBhdGggLVBhdGggJFBhcmFtVmFsdWUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpKSB7DQogICAgICAgIHRocm93ICIkKCRFUlJPUl9FWENFUFRJT05fVFlQRS5JbnB1dCkgRXJyb3IgaW4gcGFyYW1ldGVyICckUGFyYW1OYW1lJy4gTG9jYXRpb24gJyRQYXJhbVZhbHVlJyBjYW4gbm90IGJlIGFjY2Vzc2VkIGJ5IHRoZSBjdXJyZW50IGRldmljZS4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gR2V0LVRlbXBvcmFyeUZvbGRlclBhdGggew0KICAgICRyYW5kb21WYWx1ZSA9IEdldC1SYW5kb21BbHBoYU51bWVyaWNTdHJpbmcNCiAgICBpZiAoQ29uZmlybS1DdXJyZW50VXNlcklzTG9jYWxTeXN0ZW0pIHsNCiAgICAgICAgcmV0dXJuIChKb2luLVBhdGggLVBhdGggIiRlbnY6U1lTVEVNUk9PVFxOZXh0aGluayIgLUNoaWxkUGF0aCAkcmFuZG9tVmFsdWUpDQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIChKb2luLVBhdGggLVBhdGggJGVudjpURU1QIC1DaGlsZFBhdGggJHJhbmRvbVZhbHVlKQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gR2V0LVJhbmRvbUFscGhhTnVtZXJpY1N0cmluZyB7DQogICAgcmV0dXJuIFtndWlkXTo6TmV3R3VpZCgpLnRvU3RyaW5nKCdOJykNCn0NCg0KZnVuY3Rpb24gUmVtb3ZlLUZpbGUgKFtzdHJpbmddJFBhdGgpIHsNCiAgICBpZiAoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJFBhdGgpIC1vciBgDQogICAgICAgICgtbm90IChUZXN0LVBhdGggLVBhdGggJFBhdGgpKSkgeyByZXR1cm4gfQ0KDQogICAgUmVtb3ZlLUl0ZW0gLVBhdGggJFBhdGggLVJlY3Vyc2UgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlDQp9DQoNCmZ1bmN0aW9uIFdhaXQtUmFuZG9tVGltZSAoW2ludF0kTWF4aW11bURlbGF5SW5TZWNvbmRzKSB7DQogICAgaWYgKCRNYXhpbXVtRGVsYXlJblNlY29uZHMgLWd0IDApIHsNCiAgICAgICAgJHNlY29uZHMgPSBHZXQtUmFuZG9tIC1NaW5pbXVtIDAgLU1heGltdW0gJE1heGltdW1EZWxheUluU2Vjb25kcw0KICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAkc2Vjb25kcw0KICAgIH0NCn0NCg0KZnVuY3Rpb24gTmV3LUluc3RhbGxlckZvbGRlciAoW3N0cmluZ10kUGF0aCkgew0KICAgIFJlbW92ZS1GaWxlIC1QYXRoICRQYXRoDQogICAgW3ZvaWRdKE5ldy1JdGVtIC1QYXRoICRQYXRoIC1JdGVtVHlwZSAnRGlyZWN0b3J5JykNCn0NCg0KZnVuY3Rpb24gU2V0LUluc3RhbGxlckZvbGRlckFjY2Vzc1J1bGVzIChbc3RyaW5nXSRQYXRoKSB7DQogICAgW3NlY3VyaXR5LmFjY2Vzc2NvbnRyb2wuZmlsZXN5c3RlbXNlY3VyaXR5XSRhY2wgPSBHZXQtQWNsIC1QYXRoICRQYXRoDQogICAgRGlzYWJsZS1Jbmhlcml0YW5jZSAtQWNsICRhY2wNCiAgICBSZW1vdmUtQWNjZXNzRm9yT3RoZXJVc2VycyAtQWNsICRhY2wNCiAgICBTZXQtRnVsbENvbnRyb2xGb3JVc2VyIC1BY2wgJGFjbCBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAtVXNlck5hbWUgKFtzZWN1cml0eS5wcmluY2lwYWwud2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpLk5hbWUpDQogICAgU2V0LUZ1bGxDb250cm9sRm9yVXNlciAtQWNsICRhY2wgLVVzZXJOYW1lICdTWVNURU0nDQogICAgU2V0LUZvbGRlckFjbCAtQWNsICRhY2wgLVBhdGggJFBhdGgNCn0NCg0KZnVuY3Rpb24gRGlzYWJsZS1Jbmhlcml0YW5jZSAoW3NlY3VyaXR5LmFjY2Vzc2NvbnRyb2wuZmlsZXN5c3RlbXNlY3VyaXR5XSRBY2wpIHsNCiAgICBbdm9pZF0oJEFjbC5TZXRBY2Nlc3NSdWxlUHJvdGVjdGlvbigkdHJ1ZSwgJGZhbHNlKSkNCn0NCg0KZnVuY3Rpb24gUmVtb3ZlLUFjY2Vzc0Zvck90aGVyVXNlcnMgKFtzZWN1cml0eS5hY2Nlc3Njb250cm9sLmZpbGVzeXN0ZW1zZWN1cml0eV0kQWNsKSB7DQogICAgZm9yZWFjaCgkYWNjZXNzIGluICRBY2wuQWNjZXNzKSB7DQogICAgICAgIFt2b2lkXSgkQWNsLlJlbW92ZUFjY2Vzc1J1bGUoJGFjY2VzcykpDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBTZXQtRnVsbENvbnRyb2xGb3JVc2VyIChbc2VjdXJpdHkuYWNjZXNzY29udHJvbC5maWxlc3lzdGVtc2VjdXJpdHldJEFjbCwgW3N0cmluZ10kVXNlck5hbWUpIHsNCiAgICAkYXJndW1lbnRzID0gQCgkVXNlck5hbWUsICdGdWxsQ29udHJvbCcsICdDb250YWluZXJJbmhlcml0LCBPYmplY3RJbmhlcml0JywgJ05vbmUnLCAnQWxsb3cnKQ0KICAgICRhY2Nlc3NSdWxlID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgc2VjdXJpdHkuYWNjZXNzY29udHJvbC5maWxlc3lzdGVtYWNjZXNzcnVsZSBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1Bcmd1bWVudExpc3QgJGFyZ3VtZW50cw0KICAgIFt2b2lkXSgkQWNsLlNldEFjY2Vzc1J1bGUoJGFjY2Vzc1J1bGUpKQ0KfQ0KDQpmdW5jdGlvbiBTZXQtRm9sZGVyQWNsIChbc3RyaW5nXSRQYXRoLCBbc2VjdXJpdHkuYWNjZXNzY29udHJvbC5maWxlc3lzdGVtc2VjdXJpdHldJEFjbCkgew0KICAgIFNldC1BY2wgLVBhdGggJFBhdGggLUFjbE9iamVjdCAkQWNsDQp9DQoNCmZ1bmN0aW9uIEludm9rZS1JbnN0YWxsZXJEb3dubG9hZCAoW2hhc2h0YWJsZV0kSW5zdGFsbGVySW5mbykgew0KICAgIFRlc3QtSW50ZXJuZXRDb25uZWN0aXZpdHkNCiAgICBOZXctSW5zdGFsbGVyRm9sZGVyIC1QYXRoICRJbnN0YWxsZXJJbmZvLkZvbGRlcg0KICAgIFNldC1JbnN0YWxsZXJGb2xkZXJBY2Nlc3NSdWxlcyAtUGF0aCAkSW5zdGFsbGVySW5mby5Gb2xkZXINCiAgICBHZXQtSW5zdGFsbGVyRmlsZUZyb21JbnRlcm5ldCAtVXJsICRJbnN0YWxsZXJJbmZvLkluc3RhbGxlclVybCBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLVBhdGggJEluc3RhbGxlckluZm8uUGF0aA0KfQ0KDQpmdW5jdGlvbiBUZXN0LUludGVybmV0Q29ubmVjdGl2aXR5IHsNCiAgICAkdHlwZSA9IFt0eXBlXTo6R2V0VHlwZUZyb21DTFNJRCgkTkVUV09SS19NQU5BR0VSX0NMU0lEKQ0KICAgICRpbnN0YW5jZSA9IFthY3RpdmF0b3JdOjpDcmVhdGVJbnN0YW5jZSgkdHlwZSkNCg0KICAgIGlmICgtbm90ICRpbnN0YW5jZS5Jc0Nvbm5lY3RlZFRvSW50ZXJuZXQpIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLkVudmlyb25tZW50KSBObyBJbnRlcm5ldCBjb25uZWN0aW9uIGF2YWlsYWJsZS4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gR2V0LUluc3RhbGxlckZpbGVGcm9tSW50ZXJuZXQgKFtzdHJpbmddJFVybCwgW3N0cmluZ10kUGF0aCkgew0KICAgIHRyeSB7DQogICAgICAgICR3ZWJDbGllbnQgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSAnbmV0LndlYmNsaWVudCcNCiAgICAgICAgJHdlYkNsaWVudC5Eb3dubG9hZEZpbGUoJFVybCwgJFBhdGgpDQogICAgfSBjYXRjaCB7DQogICAgICAgIHRocm93ICIkKCRFUlJPUl9FWENFUFRJT05fVFlQRS5JbnRlcm5hbCkgSW1wb3NzaWJsZSB0byBkb3dubG9hZCBpbnN0YWxsZXIgZnJvbSAnJFVybCcuICINCiAgICB9IGZpbmFsbHkgew0KICAgICAgICBpZiAoJG51bGwgLW5lICR3ZWJDbGllbnQpIHsgJHdlYkNsaWVudC5EaXNwb3NlKCkgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gSW52b2tlLVByb2Nlc3MgKFtzdHJpbmddJEZpbGVQYXRoLCBbc3RyaW5nXSRBcmd1bWVudHMpIHsNCiAgICAkb3V0cHV0ID0gQHtFeGl0Q29kZSA9IC0xDQogICAgICAgICAgICAgICAgU3RkT3V0ID0gJG51bGwNCiAgICAgICAgICAgICAgICBTdGRFcnIgPSAkbnVsbH0NCiAgICAkcHJvY2Vzc0luZm8gPSBOZXctb2JqZWN0IC1UeXBlTmFtZSBkaWFnbm9zdGljcy5wcm9jZXNzc3RhcnRpbmZvDQogICAgJHByb2Nlc3NJbmZvLkNyZWF0ZU5vV2luZG93ID0gJHRydWUNCiAgICAkcHJvY2Vzc0luZm8uVXNlU2hlbGxFeGVjdXRlID0gJGZhbHNlDQogICAgJHByb2Nlc3NJbmZvLlJlZGlyZWN0U3RhbmRhcmRPdXRwdXQgPSAkdHJ1ZQ0KICAgICRwcm9jZXNzSW5mby5SZWRpcmVjdFN0YW5kYXJkRXJyb3IgPSAkdHJ1ZQ0KICAgICRwcm9jZXNzSW5mby5GaWxlTmFtZSA9ICRGaWxlUGF0aA0KICAgICRwcm9jZXNzSW5mby5Bcmd1bWVudHMgPSAkQXJndW1lbnRzDQogICAgJHByb2Nlc3NJbmZvLldvcmtpbmdEaXJlY3RvcnkgPSBTcGxpdC1QYXRoICRGaWxlUGF0aCAtUGFyZW50DQogICAgJHByb2Nlc3MgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBkaWFnbm9zdGljcy5wcm9jZXNzDQogICAgJHByb2Nlc3MuU3RhcnRJbmZvID0gJHByb2Nlc3NJbmZvDQoNCiAgICB0cnkgew0KICAgICAgICBbdm9pZF0kcHJvY2Vzcy5TdGFydCgpDQogICAgICAgICRvdXRwdXQuU3RkT3V0ID0gJHByb2Nlc3MuU3RhbmRhcmRPdXRwdXQuUmVhZFRvRW5kKCkNCiAgICAgICAgJG91dHB1dC5TdGRFcnIgPSAkcHJvY2Vzcy5TdGFuZGFyZEVycm9yLlJlYWRUb0VuZCgpDQogICAgICAgICRwcm9jZXNzLldhaXRGb3JFeGl0KCkNCiAgICB9IGNhdGNoIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLkludGVybmFsKSAnJEZpbGVQYXRoJyBleGVjdXRpb24gZmFpbGVkLiAiDQogICAgfSBmaW5hbGx5IHsNCiAgICAgICAgJG91dHB1dC5FeGl0Q29kZSA9ICRwcm9jZXNzLkV4aXRDb2RlDQogICAgICAgICRwcm9jZXNzLkRpc3Bvc2UoKQ0KICAgIH0NCg0KICAgIHJldHVybiAkb3V0cHV0DQp9DQoNCmZ1bmN0aW9uIFRlc3QtRmlsZVNpZ25hdHVyZVJvb3RDQSAoW3N0cmluZ10kUGF0aCkgew0KICAgICRmaWxlU2lnbmF0dXJlID0gR2V0LUZpbGVTaWduYXR1cmUgLVBhdGggJFBhdGgNCiAgICBUZXN0LVNpZ25hdHVyZVN0YXR1cyAtU3RhdHVzICRmaWxlU2lnbmF0dXJlLlN0YXR1cw0KDQogICAgW3N0cmluZ10kZmlsZVB1YmxpY0tleSA9IEdldC1GaWxlUm9vdENhUHVibGljS2V5IC1TaWduYXR1cmUgJGZpbGVTaWduYXR1cmUNCiAgICBbc3RyaW5nXSRmaWxlUHVibGljS2V5SGFzaCA9IEdldC1TdHJpbmdIYXNoIC1TdHJpbmcgJGZpbGVQdWJsaWNLZXkgLUhhc2hOYW1lICdTSEEyNTYnDQoNCiAgICBpZiAoLW5vdCAkVFJVU1RFRF9QVUJMSUNfQ0FTLkNvbnRhaW5zS2V5KCRmaWxlUHVibGljS2V5SGFzaCkpIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLkludGVybmFsKSBUaGUgaGFzaCBvYnRhaW5lZCAnJGZpbGVQdWJsaWNLZXlIYXNoJyBmcm9tIHRoZSByb290IENBIG9mIHRoZSBmaWxlICckUGF0aCcgaXMgbm90IGNvbnNpZGVyZWQgYXMgdHJ1c3RlZC4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gR2V0LUZpbGVTaWduYXR1cmUgKFtzdHJpbmddJFBhdGgpIHsNCiAgICB0cnkgew0KICAgICAgICByZXR1cm4gR2V0LUF1dGhlbnRpY29kZVNpZ25hdHVyZSAtRmlsZVBhdGggJFBhdGggLUVycm9yQWN0aW9uIFN0b3ANCiAgICB9IGNhdGNoIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLkludGVybmFsKSBVbmFibGUgdG8gcmV0cmlldmUgZmlsZSAnJFBhdGgnIHNpZ25hdHVyZS4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gVGVzdC1TaWduYXR1cmVTdGF0dXMgKFttYW5hZ2VtZW50LmF1dG9tYXRpb24uc2lnbmF0dXJlc3RhdHVzXSRTdGF0dXMpIHsNCiAgICBpZiAoJFN0YXR1cyAtZXEgW21hbmFnZW1lbnQuYXV0b21hdGlvbi5zaWduYXR1cmVzdGF0dXNdOjpWYWxpZCkgeyByZXR1cm4gfQ0KDQogICAgc3dpdGNoICgkU3RhdHVzKSB7DQogICAgICAgIChbbWFuYWdlbWVudC5hdXRvbWF0aW9uLnNpZ25hdHVyZXN0YXR1c106OlVua25vd25FcnJvcikgeyAkbWVzc2FnZSA9ICdGaWxlIGhhcyBhbiBpbnZhbGlkIHNpZ25hdHVyZS4gJyB9DQogICAgICAgIChbbWFuYWdlbWVudC5hdXRvbWF0aW9uLnNpZ25hdHVyZXN0YXR1c106Ok5vdFNpZ25lZCkgeyAkbWVzc2FnZSA9ICdGaWxlIGlzIG5vdCBzaWduZWQuICcgfQ0KICAgICAgICAoW21hbmFnZW1lbnQuYXV0b21hdGlvbi5zaWduYXR1cmVzdGF0dXNdOjpIYXNoTWlzbWF0Y2gpIHsgJG1lc3NhZ2UgPSAnRmlsZSBoYXNoIGRvZXMgbm90IG1hdGNoIHdpdGggdGhlIG9uZSBzdG9yZWQgaW4gdGhlIHNpZ25hdHVyZS4gJyB9DQogICAgICAgIChbbWFuYWdlbWVudC5hdXRvbWF0aW9uLnNpZ25hdHVyZXN0YXR1c106Ok5vdFRydXN0ZWQpIHsgJG1lc3NhZ2UgPSAnRmlsZSBzaWduYXR1cmUgaXMgbm90IHRydXN0ZWQuICcgfQ0KICAgICAgICAoW21hbmFnZW1lbnQuYXV0b21hdGlvbi5zaWduYXR1cmVzdGF0dXNdOjpOb3RTdXBwb3J0ZWRGaWxlRm9ybWF0KSB7ICRtZXNzYWdlID0gJ0ZpbGUgZG9lcyBub3QgaGF2ZSBzdXBwb3J0ZWQgZm9ybWF0IGZvciBzaWduaW5nIG9wZXJhdGlvbnMuICcgfQ0KICAgICAgICAoW21hbmFnZW1lbnQuYXV0b21hdGlvbi5zaWduYXR1cmVzdGF0dXNdOjpJbmNvbXBhdGlibGUpIHsgJG1lc3NhZ2UgPSAnRmlsZSBzaWduYXR1cmUgaXMgaW5jb21wYXRpYmxlIHdpdGggdGhlIGN1cnJlbnQgc3lzdGVtLiAnIH0NCiAgICAgICAgZGVmYXVsdCB7ICRtZXNzYWdlID0gIkZpbGUgc2lnbmF0dXJlIGhhcyB1bmtub3duIHN0YXR1cyAnJFN0YXR1cycuICIgfQ0KICAgIH0NCiAgICBpZiAoLW5vdCBbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkbWVzc2FnZSkpIHsgdGhyb3cgJG1lc3NhZ2UgfQ0KfQ0KDQpmdW5jdGlvbiBHZXQtRmlsZVJvb3RDYVB1YmxpY0tleSAoW29iamVjdF0kU2lnbmF0dXJlKSB7DQogICAgJHJvb3RDYSA9IEdldC1GaWxlUm9vdENhIC1TaWduYXR1cmUgJFNpZ25hdHVyZQ0KICAgIHJldHVybiAkcm9vdENhLkdldFB1YmxpY0tleVN0cmluZygpDQp9DQoNCmZ1bmN0aW9uIEdldC1GaWxlUm9vdENhIChbb2JqZWN0XSRTaWduYXR1cmUpIHsNCiAgICAkY2hhaW4gPSBHZXQtQ2VydGlmaWNhdGVDaGFpbiAtU2lnbmVyQ2VydGlmaWNhdGUgJFNpZ25hdHVyZS5TaWduZXJDZXJ0aWZpY2F0ZQ0KICAgIHJldHVybiBHZXQtUm9vdENhRnJvbUNlcnRDaGFpbiAtQ2VydENoYWluICRjaGFpbg0KfQ0KDQpmdW5jdGlvbiBHZXQtQ2VydGlmaWNhdGVDaGFpbiAoW29iamVjdF0kU2lnbmVyQ2VydGlmaWNhdGUpIHsNCiAgICAkY2hhaW4gPSBOZXctT2JqZWN0IC1UeXBlTmFtZSAnc2VjdXJpdHkuY3J5cHRvZ3JhcGh5Lng1MDljZXJ0aWZpY2F0ZXMueDUwOWNoYWluJw0KICAgIFt2b2lkXSgkY2hhaW4uQnVpbGQoJFNpZ25lckNlcnRpZmljYXRlKSkNCiAgICByZXR1cm4gJGNoYWluDQp9DQoNCmZ1bmN0aW9uIEdldC1Sb290Q2FGcm9tQ2VydENoYWluIChbb2JqZWN0XSRDZXJ0Q2hhaW4pIHsNCiAgICByZXR1cm4gJENlcnRDaGFpbi5DaGFpbkVsZW1lbnRzIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgQ2VydGlmaWNhdGUgLUxhc3QgMQ0KfQ0KDQpmdW5jdGlvbiBHZXQtU3RyaW5nSGFzaCAoW3N0cmluZ10kU3RyaW5nLCBbc3RyaW5nXSRIYXNoTmFtZSkgew0KICAgICRoYXNoQnl0ZXMgPSBbc2VjdXJpdHkuY3J5cHRvZ3JhcGh5Lmhhc2hhbGdvcml0aG1dOjpDcmVhdGUoJEhhc2hOYW1lKS5Db21wdXRlSGFzaChbc3lzdGVtLnRleHQuZW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCRTdHJpbmcpKQ0KICAgIHJldHVybiBbYml0Y29udmVydGVyXTo6VG9TdHJpbmcoJGhhc2hCeXRlcykgLXJlcGxhY2UgJy0nLCAnJw0KfQ0KDQpmdW5jdGlvbiBVbmJsb2NrLUluc3RhbGxlciAoW3N0cmluZ10kUGF0aCkgew0KICAgIFt2b2lkXShJbnZva2UtUHJvY2VzcyAtRmlsZVBhdGggJENNRF9FWEUgYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAtQXJndW1lbnRzICgkVU5CTE9DS19DT01NQU5EIC1mICRQYXRoKSkNCn0NCg0KZnVuY3Rpb24gSW5zdGFsbC1BcHBsaWNhdGlvbiAoW3N0cmluZ10kUGF0aCwgW3N0cmluZ10kQXJndW1lbnRzKSB7DQogICAgW3ZvaWRdKEludm9rZS1Qcm9jZXNzIC1GaWxlUGF0aCAkUGF0aCBgDQogICAgICAgICAgICAgICAgICAgICAgICAgIC1Bcmd1bWVudHMgJEFyZ3VtZW50cykNCn0NCg0KZnVuY3Rpb24gVGVzdC1GaWxlUGF0aCAoW3N0cmluZ10kUGF0aCkgew0KICAgIGlmIChbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkUGF0aCkgLW9yIGANCiAgICAgICAgLW5vdCAoVGVzdC1QYXRoIC1QYXRoICRQYXRoIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKSkgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuRW52aXJvbm1lbnQpIEZpbGUgJyRQYXRoJyBpcyBub3QgZm91bmQgb3IgYWNjZXNzIGRlbmllZC4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gVGVzdC1GaWxlSGFzaCAoW3N0cmluZ10kUGF0aCwgW3N0cmluZ10kRXhwZWN0ZWRIYXNoKSB7DQogICAgJGZpbGVIYXNoID0gR2V0LUhhc2ggLVBhdGggJFBhdGgNCiAgICBpZiAoJGZpbGVIYXNoIC1uZSAkRXhwZWN0ZWRIYXNoKSB7DQogICAgICAgIHRocm93ICIkKCRFUlJPUl9FWENFUFRJT05fVFlQRS5JbnRlcm5hbCkgRmlsZSAnJFBhdGgnIFNIQS0yNTYgaGFzaCAnJGZpbGVIYXNoJyBkb2VzIG5vdCBtYXRjaCBleHBlY3RlZCBoYXNoICckRXhwZWN0ZWRIYXNoJy4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gR2V0LUhhc2ggKFtzdHJpbmddJFBhdGgpIHsNCiAgICB0cnkgew0KICAgICAgICAkaGFzaGVyID0gW3NlY3VyaXR5LmNyeXB0b2dyYXBoeS5oYXNoYWxnb3JpdGhtXTo6Q3JlYXRlKCdTSEEyNTYnKQ0KICAgICAgICAkZmlsZSA9IFtpby5maWxlXTo6T3BlblJlYWQoJFBhdGgpDQogICAgICAgICRjb21wdXRlZEhhc2ggPSAkaGFzaGVyLkNvbXB1dGVIYXNoKCRmaWxlKQ0KDQogICAgICAgIHJldHVybiBbYml0Y29udmVydGVyXTo6VG9TdHJpbmcoJGNvbXB1dGVkSGFzaCkgLXJlcGxhY2UgJy0nLCAnJw0KICAgIH0gY2F0Y2ggew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuSW50ZXJuYWwpIEVycm9yIGNhbGN1bGF0aW5nIGhhc2ggb2YgdGhlIGZpbGUgJyRQYXRoJy4gIg0KICAgIH0gZmluYWxseSB7DQogICAgICAgIGlmICgkbnVsbCAtbmUgJGZpbGUpIHsgJGZpbGUuRGlzcG9zZSgpIH0NCiAgICB9DQp9DQoNCiMNCiMgSW5wdXQgcGFyYW1ldGVyIHZhbGlkYXRpb24NCiMNCmZ1bmN0aW9uIFRlc3QtSW5wdXRQYXJhbWV0ZXJzIChbaGFzaHRhYmxlXSRJbnB1dFBhcmFtZXRlcnMpIHsNCiAgICBUZXN0LVBhcmFtSW5BbGxvd2VkUmFuZ2UgYA0KICAgICAgICAtUGFyYW1OYW1lICdNYXhpbXVtRGVsYXlJblNlY29uZHMnIGANCiAgICAgICAgLVBhcmFtVmFsdWUgJElucHV0UGFyYW1ldGVycy5NYXhpbXVtRGVsYXlJblNlY29uZHMgYA0KICAgICAgICAtTG93ZXJMaW1pdCAwIGANCiAgICAgICAgLVVwcGVyTGltaXQgJE1BWF9TQ1JJUFRfREVMQVlfU0VDDQogICAgVGVzdC1JbnN0YWxsZXJTb3VyY2UgYA0KICAgICAgICAtUGFyYW1OYW1lICdJbnN0YWxsZXJTb3VyY2UnIGANCiAgICAgICAgLVBhcmFtVmFsdWUgJElucHV0UGFyYW1ldGVycy5JbnN0YWxsZXJTb3VyY2UNCiAgICBpZiAoQ29uZmlybS1TdHJpbmdJc05vdEVtcHR5IC1WYWx1ZSAkSW5wdXRQYXJhbWV0ZXJzLkluc3RhbGxlckhhc2gpIHsNCiAgICAgICAgVGVzdC1TaGEyNTZQYXJhbWV0ZXIgYA0KICAgICAgICAgICAgLVBhcmFtTmFtZSAnSW5zdGFsbGVySGFzaCcgYA0KICAgICAgICAgICAgLVBhcmFtVmFsdWUgJElucHV0UGFyYW1ldGVycy5JbnN0YWxsZXJIYXNoDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBUZXN0LUluc3RhbGxlclNvdXJjZSAoW3N0cmluZ10kUGFyYW1OYW1lLCBbc3RyaW5nXSRQYXJhbVZhbHVlKSB7DQogICAgaWYgKFRlc3QtSXNVTkNQYXRoIC1QYXRoICRQYXJhbVZhbHVlKSB7DQogICAgICAgIFRlc3QtUGF0aFJlYWRhYmxlIC1QYXJhbU5hbWUgJFBhcmFtTmFtZSAtUGFyYW1WYWx1ZSAkUGFyYW1WYWx1ZQ0KICAgIH0gZWxzZSB7DQogICAgICAgIFRlc3QtVVJMIC1QYXJhbU5hbWUgJFBhcmFtTmFtZSAtUGFyYW1WYWx1ZSAkUGFyYW1WYWx1ZQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gVGVzdC1Jc1VOQ1BhdGggKFtzdHJpbmddJFBhdGgpIHsNCiAgICByZXR1cm4gKFt1cmldJFBhdGgpLklzVW5jDQp9DQoNCmZ1bmN0aW9uIFRlc3QtVVJMIChbc3RyaW5nXSRQYXJhbU5hbWUsIFtzdHJpbmddJFBhcmFtVmFsdWUpIHsNCiAgICAkc3RhdHVzQ29kZSA9ICcnDQoNCiAgICB0cnkgew0KICAgICAgICAkcmVxdWVzdCA9IEdldC1XZWJSZXF1ZXN0IC1VcmwgJFBhcmFtVmFsdWUNCiAgICAgICAgJHJlcXVlc3QuTWV0aG9kID0gJ0hFQUQnDQogICAgICAgICRyZXNwb25zZSA9IEdldC1XZWJSZXNwb25zZSAtUmVxdWVzdCAkcmVxdWVzdA0KICAgICAgICAkc3RhdHVzQ29kZSA9ICRyZXNwb25zZS5TdGF0dXNDb2RlDQogICAgfSBjYXRjaCB7DQogICAgICAgIHRocm93ICJQYXJhbWV0ZXIgJyRQYXJhbU5hbWUnIGlzIGFuIGludmFsaWQgVVJMLiBFcnJvciB3aGVuIGNvbm5lY3RpbmcgdG8gJyRQYXJhbVZhbHVlJy4gIg0KICAgIH0gZmluYWxseSB7DQogICAgICAgIGlmICgkbnVsbCAtbmUgJHJlc3BvbnNlKSB7DQogICAgICAgICAgICAkcmVzcG9uc2UuQ2xvc2UoKQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgaWYgKCRzdGF0dXNDb2RlIC1uZSAnT0snKSB7DQogICAgICAgIHRocm93ICJQYXJhbWV0ZXIgJyRQYXJhbU5hbWUnIGlzIGFuIFVSTCB3aXRoIHVuZXhwZWN0ZWQgcmVzcG9uc2UuIE9idGFpbmVkIHN0YXR1cyBjb2RlICckc3RhdHVzQ29kZScgd2hlbiBjb25uZWN0aW5nIHRvICckUGFyYW1WYWx1ZScuICINCiAgICB9DQp9DQoNCmZ1bmN0aW9uIEdldC1XZWJSZXF1ZXN0IChbc3RyaW5nXSRVcmwpIHsNCiAgICByZXR1cm4gW25ldC53ZWJyZXF1ZXN0XTo6Q3JlYXRlKCRVcmwpDQp9DQoNCmZ1bmN0aW9uIEdldC1XZWJSZXNwb25zZSAoW3Bzb2JqZWN0XSRSZXF1ZXN0KSB7DQogICAgcmV0dXJuICRSZXF1ZXN0LkdldFJlc3BvbnNlKCkNCn0NCg0KIw0KIyBJbnN0YWxsIGFwcGxpY2F0aW9uIG1hbmFnZW1lbnQNCiMNCmZ1bmN0aW9uIEluaXRpYWxpemUtSW5zdGFsbGVySW5mb3JtYXRpb24gKFtoYXNodGFibGVdJElucHV0UGFyYW1ldGVycykgew0KICAgICR0ZW1wTG9jYWxGaWxlID0gR2V0LUxvY2FsTmFtZUJ5SW5zdGFsbGVyVHlwZSAtU291cmNlICRJbnB1dFBhcmFtZXRlcnMuSW5zdGFsbGVyU291cmNlDQogICAgJGZvbGRlciA9IEdldC1UZW1wb3JhcnlGb2xkZXJQYXRoDQogICAgcmV0dXJuIEB7SW5zdGFsbGVyVXJsID0gJElucHV0UGFyYW1ldGVycy5JbnN0YWxsZXJTb3VyY2UNCiAgICAgICAgICAgICBGb2xkZXIgPSAkZm9sZGVyDQogICAgICAgICAgICAgUGF0aCA9IEpvaW4tUGF0aCAtUGF0aCAkZm9sZGVyIC1DaGlsZFBhdGggJHRlbXBMb2NhbEZpbGUNCiAgICAgICAgICAgICBIYXNoID0gRm9ybWF0LVN0cmluZ1ZhbHVlIC1WYWx1ZSAkSW5wdXRQYXJhbWV0ZXJzLkluc3RhbGxlckhhc2gNCiAgICAgICAgICAgICBJbnN0YWxsYXRpb25EZWxheSA9ICRJbnB1dFBhcmFtZXRlcnMuTWF4aW11bURlbGF5SW5TZWNvbmRzIC1hcyBbaW50XQ0KICAgICAgICAgICAgIEluc3RhbGxhdGlvbkFyZ3VtZW50cyA9ICRJbnB1dFBhcmFtZXRlcnMuSW5zdGFsbFBhcmFtZXRlcnN9DQp9DQoNCmZ1bmN0aW9uIEdldC1Mb2NhbE5hbWVCeUluc3RhbGxlclR5cGUgKFtzdHJpbmddJFNvdXJjZSkgew0KICAgIHJldHVybiAkKGlmIChUZXN0LUluc3RhbGxlclNvdXJjZUlzTVNJIC1Tb3VyY2UgJFNvdXJjZSkgeyAkTVNJX0lOU1RBTExFUl9URU1QX0ZJTEVfTkFNRSB9DQogICAgICAgICAgICAgZWxzZSB7ICRDVVNUT01fSU5TVEFMTEVSX1RFTVBfRklMRV9OQU1FIH0pDQp9DQoNCmZ1bmN0aW9uIFRlc3QtSW5zdGFsbGVyU291cmNlSXNNU0kgKFtzdHJpbmddJFNvdXJjZSkgew0KICAgIHJldHVybiAkU291cmNlLlRvTG93ZXIoKS5FbmRzV2l0aCgnLm1zaScpDQp9DQoNCmZ1bmN0aW9uIEluc3RhbGwtQXBwbGljYXRpb25Pck1zaSAoW2hhc2h0YWJsZV0kSW5zdGFsbGVySW5mbykgew0KICAgIHRyeSB7DQogICAgICAgIENvcHktSW5zdGFsbGVyVG9Mb2NhbEZvbGRlciAtSW5zdGFsbGVySW5mbyAkSW5zdGFsbGVySW5mbw0KICAgICAgICBpZiAoVGVzdC1JbnN0YWxsZXJTb3VyY2VJc01TSSAtU291cmNlICRJbnN0YWxsZXJJbmZvLlBhdGgpIHsNCiAgICAgICAgICAgICRpbnN0YWxsYXRpb25SZXN1bHQgPSBJbnZva2UtTVNJSW5zdGFsbGVyIC1JbnN0YWxsZXJQYXRoICRJbnN0YWxsZXJJbmZvLlBhdGggYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUFyZ3VtZW50cyAkSW5zdGFsbGVySW5mby5JbnN0YWxsYXRpb25Bcmd1bWVudHMNCiAgICAgICAgICAgICRpbnN0YWxsYXRpb25SZXN1bHRNZXNzYWdlID0gR2V0LUluc3RhbGxhdGlvblJlc3VsdE1lc3NhZ2UgLVJlc3VsdCAkaW5zdGFsbGF0aW9uUmVzdWx0DQogICAgICAgICAgICBXcml0ZS1TdGF0dXNNZXNzYWdlIC1NZXNzYWdlICRpbnN0YWxsYXRpb25SZXN1bHRNZXNzYWdlDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBJbnZva2UtSW5zdGFsbGF0aW9uIC1JbnN0YWxsZXJJbmZvICRJbnN0YWxsZXJJbmZvDQogICAgICAgICAgICBXcml0ZS1TdGF0dXNNZXNzYWdlIC1NZXNzYWdlICdJbnN0YWxsYXRpb24gcHJvY2VzcyBmaW5pc2hlZCBzdWNjZXNzZnVsbHkuICcNCiAgICAgICAgfQ0KICAgIH0NCiAgICBmaW5hbGx5IHsNCiAgICAgICAgUmVtb3ZlLUZpbGUgLVBhdGggJEluc3RhbGxlckluZm8uRm9sZGVyDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBDb3B5LUluc3RhbGxlclRvTG9jYWxGb2xkZXIgKFtoYXNodGFibGVdJEluc3RhbGxlckluZm8pIHsNCiAgICBXYWl0LVJhbmRvbVRpbWUgLU1heGltdW1EZWxheUluU2Vjb25kcyAkSW5zdGFsbGVySW5mby5JbnN0YWxsYXRpb25EZWxheQ0KICAgIGlmIChUZXN0LUlzVU5DUGF0aCAtUGF0aCAkSW5zdGFsbGVySW5mby5JbnN0YWxsZXJVcmwpIHsNCiAgICAgICAgTmV3LUluc3RhbGxlckZvbGRlciAtUGF0aCAkSW5zdGFsbGVySW5mby5Gb2xkZXINCiAgICAgICAgU2V0LUluc3RhbGxlckZvbGRlckFjY2Vzc1J1bGVzIC1QYXRoICRJbnN0YWxsZXJJbmZvLkZvbGRlcg0KICAgICAgICBDb3B5LUl0ZW0gLVBhdGggJEluc3RhbGxlckluZm8uSW5zdGFsbGVyVXJsIC1EZXN0aW5hdGlvbiAkSW5zdGFsbGVySW5mby5QYXRoDQogICAgfSBlbHNlIHsNCiAgICAgICAgSW52b2tlLUluc3RhbGxlckRvd25sb2FkIC1JbnN0YWxsZXJJbmZvICRJbnN0YWxsZXJJbmZvDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBJbnZva2UtTVNJSW5zdGFsbGVyIChbc3RyaW5nXSRJbnN0YWxsZXJQYXRoLCBbc3RyaW5nXSRBcmd1bWVudHMpIHsNCiAgICBpZiAoQ29uZmlybS1TdHJpbmdJc05vdEVtcHR5IC1WYWx1ZSAkQXJndW1lbnRzKSB7DQogICAgICAgICRtc2lBcmd1bWVudHMgPSAnezB9IHsxfSB7Mn0gezN9ICJ7NH0iIHs1fScgLWYgJE1TSV9JTlNUQUxMRVJfUVVJRVRfT1BUSU9OLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRNU0lfSU5TVEFMTEVSX05PX1JFQk9PVF9PUFRJT04sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1TSV9JTlNUQUxMRVJfU1VQUFJFU1NfUkVCT09UX09QVElPTiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTVNJX0lOU1RBTExFUl9JTlNUQUxMX09QVElPTiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkSW5zdGFsbGVyUGF0aCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQXJndW1lbnRzDQogICAgfSBlbHNlIHsNCiAgICAgICAgJG1zaUFyZ3VtZW50cyA9ICd7MH0gInsxfSIgezJ9IHszfSB7NH0nIC1mICRNU0lfSU5TVEFMTEVSX0lOU1RBTExfT1BUSU9OLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJEluc3RhbGxlclBhdGgsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTVNJX0lOU1RBTExFUl9RVUlFVF9PUFRJT04sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkTVNJX0lOU1RBTExFUl9OT19SRUJPT1RfT1BUSU9OLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1TSV9JTlNUQUxMRVJfU1VQUFJFU1NfUkVCT09UX09QVElPTg0KICAgIH0NCiAgICByZXR1cm4gKEludm9rZS1Qcm9jZXNzIC1GaWxlUGF0aCAkTVNJX0lOU1RBTExFUl9QQVRIIC1Bcmd1bWVudHMgJG1zaUFyZ3VtZW50cykuRXhpdENvZGUNCn0NCg0KZnVuY3Rpb24gR2V0LUluc3RhbGxhdGlvblJlc3VsdE1lc3NhZ2UgKFtpbnRdJFJlc3VsdCkgew0KICAgIHN3aXRjaCAoJFJlc3VsdCkgew0KICAgICAgICAkTVNJX0lOU1RBTExFUl9TVUNDRVNTIGANCiAgICAgICAgICAgIHsgcmV0dXJuICdJbnN0YWxsYXRpb24gcHJvY2VzcyBmaW5pc2hlZCBzdWNjZXNzZnVsbHkuICcgfQ0KICAgICAgICAkTVNJX0lOU1RBTExFUl9TVUNDRVNTX1JFQk9PVF9JTklUSUFURUQgYA0KICAgICAgICAgICAgeyByZXR1cm4gJ0luc3RhbGxhdGlvbiBwcm9jZXNzIGZpbmlzaGVkIHN1Y2Nlc3NmdWxseSwgcmVib290IGhhcyBiZWVuIGluaXRpYXRlZC4gJyB9DQogICAgICAgICRNU0lfSU5TVEFMTEVSX1NVQ0NFU1NfUkVCT09UX1JFUVVJUkVEIGANCiAgICAgICAgICAgIHsgcmV0dXJuICdJbnN0YWxsYXRpb24gcHJvY2VzcyBmaW5pc2hlZCBzdWNjZXNzZnVsbHksIHJlYm9vdCBpcyByZXF1aXJlZC4gJyB9DQoNCiAgICAgICAgZGVmYXVsdCB7IHRocm93ICJJbnN0YWxsYXRpb24gY2Fubm90IGJlIGNvbXBsZXRlZC4gRXhpdENvZGU6ICRSZXN1bHQuICIgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gSW52b2tlLUluc3RhbGxhdGlvbiAoW2hhc2h0YWJsZV0kSW5zdGFsbGVySW5mbykgew0KICAgIGlmIChDb25maXJtLVN0cmluZ0lzTm90RW1wdHkgLVZhbHVlICRJbnN0YWxsZXJJbmZvLkhhc2gpIHsNCiAgICAgICAgVGVzdC1IYXNoSW50ZWdyaXR5IC1GaWxlSW5mbyAkSW5zdGFsbGVySW5mbw0KICAgIH0gZWxzZSB7DQogICAgICAgIFRlc3QtRmlsZVNpZ25hdHVyZVJvb3RDQSAtUGF0aCAkSW5zdGFsbGVySW5mby5QYXRoDQogICAgfQ0KICAgIFVuYmxvY2stSW5zdGFsbGVyIC1QYXRoICRJbnN0YWxsZXJJbmZvLlBhdGgNCiAgICBJbnN0YWxsLUFwcGxpY2F0aW9uIC1QYXRoICRJbnN0YWxsZXJJbmZvLlBhdGggYA0KICAgICAgICAgICAgICAgICAgICAgICAgLUFyZ3VtZW50cyAkSW5zdGFsbGVySW5mby5JbnN0YWxsYXRpb25Bcmd1bWVudHMNCn0NCg0KZnVuY3Rpb24gVGVzdC1IYXNoSW50ZWdyaXR5IChbaGFzaHRhYmxlXSRGaWxlSW5mbykgew0KICAgIFRlc3QtRmlsZVBhdGggLVBhdGggJEZpbGVJbmZvLlBhdGgNCg0KICAgIGlmIChDb25maXJtLVN0cmluZ0lzTm90RW1wdHkgLVZhbHVlICRGaWxlSW5mby5IYXNoKSB7DQogICAgICAgIFRlc3QtRmlsZUhhc2ggLVBhdGggJEZpbGVJbmZvLlBhdGggLUV4cGVjdGVkSGFzaCAkRmlsZUluZm8uSGFzaA0KICAgIH0NCn0NCg0KIw0KIyBNYWluIHNjcmlwdCBmbG93DQojDQpbZW52aXJvbm1lbnRdOjpFeGl0KChJbnZva2UtTWFpbiAtSW5wdXRQYXJhbWV0ZXJzICRNeUludm9jYXRpb24uQm91bmRQYXJhbWV0ZXJzKSkNCg=="}}}