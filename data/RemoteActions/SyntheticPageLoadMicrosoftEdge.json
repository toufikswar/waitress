{"id": "Synthetic_Page_Load_Microsoft_Edge_windows", "name": "Synthetic Page Load Microsoft Edge", "description": "Invokes the execution of URLs through Microsoft Edge based on URLs set in the input parameter, after 30 seconds Microsoft Edge will be closed.", "purpose": ["REMEDIATION"], "targeting": {"apiEnabled": true, "manualEnabled": false, "manualAllowMultipleDevices": true}, "scriptInfo": {"runAs": "INTERACTIVE_USER", "timeoutSeconds": 120, "inputs": [{"description": "URL or URLs to be loaded, if more than one URL is specified, separate them by using semicolons", "id": "URLsToLoad", "name": "URLsToLoad", "options": ["''"], "allowCustomValue": false, "usedByWindows": true, "usedByMacOs": false}], "outputs": [], "scriptWindows": {"name": "Invoke-URLEdge.ps1", "script": "77u/PCMNCi5TWU5PUFNJUw0KSW52b2tlcyB0aGUgZXhlY3V0aW9uIG9mIFVSTHMgdGhyb3VnaCBNaWNyb3NvZnQgRWRnZS4NCg0KLkRFU0NSSVBUSU9ODQpJbnZva2VzIHRoZSBleGVjdXRpb24gb2YgVVJMcyB0aHJvdWdoIE1pY3Jvc29mdCBFZGdlIGJhc2VkIG9uIFVSTHMgc2V0IGluIHRoZSBpbnB1dCBwYXJhbWV0ZXIsIGFmdGVyIDMwIHNlY29uZHMgTWljcm9zb2Z0IEVkZ2Ugd2lsbCBiZSBjbG9zZWQuDQoNCi5GVU5DVElPTkFMSVRZDQpSZW1lZGlhdGlvbg0KDQouSU5QVVRTDQpJRCAgTGFiZWwgICAgICAgICAgICAgICAgICAgICAgICAgICBEZXNjcmlwdGlvbg0KMSAgIFVSTHNUb0xvYWQgICAgICAgICAgICAgICAgICAgICAgVVJMIG9yIFVSTHMgdG8gYmUgbG9hZGVkLCBpZiBtb3JlIHRoYW4gb25lIFVSTCBpcyBzcGVjaWZpZWQsIHNlcGFyYXRlIHRoZW0gYnkgdXNpbmcgc2VtaWNvbG9ucw0KDQouUkVTVFJJQ1RJT05TDQotIENvbXBhdGlibGUgb25seSB3aXRoIE1pY3Jvc29mdCBFZGdlIDc3IGFuZCBvbndhcmRzLg0KDQouTk9URVMNCkNvbnRleHQ6ICAgICAgICAgICAgSW50ZXJhY3RpdmVVc2VyDQpWZXJzaW9uOiAgICAgICAgICAgIDEuMC4wLjAgLSBJbml0aWFsIHJlbGVhc2UNCkxhc3QgR2VuZXJhdGVkOiAgICAgMjcgQXByIDIwMjIgLSAxMDowMzo0NA0KQ29weXJpZ2h0IChDKSAyMDIyIE5leHRoaW5rIFNBLCBTd2l0emVybGFuZA0KIz4NCiMNCiMgSW5wdXQgcGFyYW1ldGVycyBkZWZpbml0aW9uDQojDQpwYXJhbSgNCiAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV1bc3RyaW5nXSRVUkxzVG9Mb2FkDQopDQojIEVuZCBvZiBwYXJhbWV0ZXJzIGRlZmluaXRpb24NCg0KJGVudjpQYXRoID0gIiRlbnY6U3lzdGVtUm9vdFxzeXN0ZW0zMjskZW52OlN5c3RlbVJvb3Q7JGVudjpTeXN0ZW1Sb290XFN5c3RlbTMyXFdiZW07JGVudjpTeXN0ZW1Sb290XFN5c3RlbTMyXFdpbmRvd3NQb3dlclNoZWxsXHYxLjBcIg0KDQojDQojIENvbnN0YW50cyBkZWZpbml0aW9uDQojDQpOZXctVmFyaWFibGUgLU5hbWUgJ0VSUk9SX0VYQ0VQVElPTl9UWVBFJyBgDQogICAgLVZhbHVlIEB7RW52aXJvbm1lbnQgPSAnW0Vudmlyb25tZW50IGVycm9yXScNCiAgICAgICAgICAgICBJbnB1dCA9ICdbSW5wdXQgZXJyb3JdJw0KICAgICAgICAgICAgIEludGVybmFsID0gJ1tJbnRlcm5hbCBlcnJvcl0nfSBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0DQpOZXctVmFyaWFibGUgLU5hbWUgJ0xPQ0FMX1NZU1RFTV9JREVOVElUWScgYA0KICAgIC1WYWx1ZSAnUy0xLTUtMTgnIC1PcHRpb24gUmVhZE9ubHkgLVNjb3BlIFNjcmlwdA0KTmV3LVZhcmlhYmxlIC1OYW1lICdOVU1fUkVUUklFUycgYA0KICAgIC1WYWx1ZSAyNSBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0DQpOZXctVmFyaWFibGUgLU5hbWUgJ1JFVFJZX1dBSVRfTVMnIGANCiAgICAtVmFsdWUgMjAwIGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQNCk5ldy1WYXJpYWJsZSAtTmFtZSAnV0lORE9XU19WRVJTSU9OUycgYA0KICAgIC1WYWx1ZSBAe1dpbmRvd3M3ID0gJzYuMScNCiAgICAgICAgICAgICBXaW5kb3dzOCA9ICc2LjInDQogICAgICAgICAgICAgV2luZG93czgxID0gJzYuMycNCiAgICAgICAgICAgICBXaW5kb3dzMTAgPSAnMTAuMCcNCiAgICAgICAgICAgICBXaW5kb3dzMTEgPSAnMTAuMCd9IGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQNCg0KTmV3LVZhcmlhYmxlIC1OYW1lICdNSUNST1NPRlRfRURHRV9SRUdJU1RSWV9LRVknIGANCiAgICAtVmFsdWUgJ1JlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cQXBwIFBhdGhzXG1zZWRnZS5leGUnIGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQgLUZvcmNlDQpOZXctVmFyaWFibGUgLU5hbWUgJ01JQ1JPU09GVF9FREdFX1JFR0lTVFJZX1BST1BFUlRZJyBgDQogICAgLVZhbHVlICcoRGVmYXVsdCknIGANCiAgICAtT3B0aW9uIFJlYWRPbmx5IC1TY29wZSBTY3JpcHQgLUZvcmNlDQpOZXctVmFyaWFibGUgLU5hbWUgJ01JQ1JPU09GVF9FREdFX1BST0NFU1NfTkFNRScgYA0KICAgIC1WYWx1ZSAnbXNlZGdlJyBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0IC1Gb3JjZQ0KTmV3LVZhcmlhYmxlIC1OYW1lICdNSUNST1NPRlRfRURHRV9TVVBQT1JURURfVkVSU0lPTicgYA0KICAgIC1WYWx1ZSA3NyBgDQogICAgLU9wdGlvbiBSZWFkT25seSAtU2NvcGUgU2NyaXB0IC1Gb3JjZQ0KDQojDQojIEludm9rZSBNYWluDQojDQpmdW5jdGlvbiBJbnZva2UtTWFpbiAoW2hhc2h0YWJsZV0kSW5wdXRQYXJhbWV0ZXJzKSB7DQogICAgJGV4aXRDb2RlID0gMA0KDQogICAgdHJ5IHsNCiAgICAgICAgVGVzdC1SdW5uaW5nQXNJbnRlcmFjdGl2ZVVzZXINCiAgICAgICAgVGVzdC1NaW5pbXVtU3VwcG9ydGVkT1NWZXJzaW9uIC1XaW5kb3dzVmVyc2lvbiAnV2luZG93czEwJw0KDQogICAgICAgIFRlc3QtVVJMc0FyZVZhbGlkDQogICAgICAgIFRlc3QtU3VwcG9ydGVkTWljcm9zb2Z0RWRnZVZlcnNpb24NCg0KICAgICAgICBJbnZva2UtRWRnZVByb2Nlc3MNCiAgICB9IGNhdGNoIHsNCiAgICAgICAgV3JpdGUtU3RhdHVzTWVzc2FnZSAtTWVzc2FnZSAkXw0KICAgICAgICAkZXhpdENvZGUgPSAxDQogICAgfQ0KDQogICAgcmV0dXJuICRleGl0Q29kZQ0KfQ0KDQojDQojIFRlbXBsYXRlIGZ1bmN0aW9ucw0KIw0KZnVuY3Rpb24gVGVzdC1SdW5uaW5nQXNJbnRlcmFjdGl2ZVVzZXIgew0KICAgIGlmIChDb25maXJtLUN1cnJlbnRVc2VySXNMb2NhbFN5c3RlbSkgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuRW52aXJvbm1lbnQpIFRoaXMgc2NyaXB0IG11c3QgYmUgcnVuIGFzIEludGVyYWN0aXZlVXNlci4gIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gQ29uZmlybS1DdXJyZW50VXNlcklzTG9jYWxTeXN0ZW0gew0KICAgICRjdXJyZW50SWRlbnRpdHkgPSBHZXQtQ3VycmVudElkZW50aXR5DQogICAgcmV0dXJuICRjdXJyZW50SWRlbnRpdHkgLWVxICRMT0NBTF9TWVNURU1fSURFTlRJVFkNCn0NCg0KZnVuY3Rpb24gR2V0LUN1cnJlbnRJZGVudGl0eSB7DQogICAgcmV0dXJuIFtzZWN1cml0eS5wcmluY2lwYWwud2luZG93c2lkZW50aXR5XTo6R2V0Q3VycmVudCgpLlVzZXIuVG9TdHJpbmcoKQ0KfQ0KDQpmdW5jdGlvbiBUZXN0LU1pbmltdW1TdXBwb3J0ZWRPU1ZlcnNpb24gKFtzdHJpbmddJFdpbmRvd3NWZXJzaW9uLCBbc3dpdGNoXSRTdXBwb3J0ZWRXaW5kb3dzU2VydmVyKSB7DQogICAgJGN1cnJlbnRPU0luZm8gPSBHZXQtT1NWZXJzaW9uVHlwZQ0KICAgICRPU1ZlcnNpb24gPSAkY3VycmVudE9TSW5mby5WZXJzaW9uIC1hcyBbdmVyc2lvbl0NCg0KICAgICRzdXBwb3J0ZWRXaW5kb3dzID0gJFdJTkRPV1NfVkVSU0lPTlMuJFdpbmRvd3NWZXJzaW9uIC1hcyBbdmVyc2lvbl0NCg0KICAgIGlmICgtbm90ICgkY3VycmVudE9TSW5mbykpIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLkVudmlyb25tZW50KSBUaGlzIHNjcmlwdCBjb3VsZCBub3QgcmV0dXJuIE9TIHZlcnNpb24uICINCiAgICB9DQoNCiAgICBpZiAoICRTdXBwb3J0ZWRXaW5kb3dzU2VydmVyIC1lcSAkZmFsc2UgLWFuZCAkY3VycmVudE9TSW5mby5Qcm9kdWN0VHlwZSAtbmUgMSkgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuRW52aXJvbm1lbnQpIFRoaXMgc2NyaXB0IGlzIG5vdCBjb21wYXRpYmxlIHdpdGggV2luZG93cyBTZXJ2ZXJzLiAiDQogICAgfQ0KDQogICAgaWYgKCAkT1NWZXJzaW9uIC1sdCAkc3VwcG9ydGVkV2luZG93cykgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuRW52aXJvbm1lbnQpIFRoaXMgc2NyaXB0IGlzIGNvbXBhdGlibGUgd2l0aCAkV2luZG93c1ZlcnNpb24gYW5kIGxhdGVyIG9ubHkuICINCiAgICB9DQp9DQoNCmZ1bmN0aW9uIEdldC1PU1ZlcnNpb25UeXBlIHsNCiAgICByZXR1cm4gR2V0LVdpbmRvd3NNYW5hZ2VtZW50RGF0YSAtQ2xhc3MgV2luMzJfT3BlcmF0aW5nU3lzdGVtIHwgU2VsZWN0LU9iamVjdCAtUHJvcGVydHkgVmVyc2lvbixQcm9kdWN0VHlwZQ0KfQ0KDQpmdW5jdGlvbiBHZXQtV2luZG93c01hbmFnZW1lbnREYXRhIChbc3RyaW5nXSRDbGFzcywgW3N0cmluZ10kTmFtZXNwYWNlID0gJ3Jvb3QvY2ltdjInKSB7DQogICAgdHJ5IHsNCiAgICAgICAgJHF1ZXJ5ID0gW3dtaXNlYXJjaGVyXSAiU2VsZWN0ICogZnJvbSAkQ2xhc3MiDQogICAgICAgICRxdWVyeS5TY29wZS5QYXRoID0gIiROYW1lc3BhY2UiDQogICAgICAgICRxdWVyeS5HZXQoKQ0KICAgIH0gY2F0Y2ggew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuRW52aXJvbm1lbnQpIEVycm9yIGdldHRpbmcgQ0lNL1dNSSBpbmZvcm1hdGlvbi4gVmVyaWZ5IFdpbk1nbXQgc2VydmljZSBzdGF0dXMgYW5kIFdNSSByZXBvc2l0b3J5IGNvbnNpc3RlbmN5LiAiDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBXcml0ZS1TdGF0dXNNZXNzYWdlIChbcHNvYmplY3RdJE1lc3NhZ2UpIHsNCiAgICAkZXhjZXB0aW9uTWVzc2FnZSA9ICRNZXNzYWdlLlRvU3RyaW5nKCkNCg0KICAgIGlmICgkTWVzc2FnZS5JbnZvY2F0aW9uSW5mby5TY3JpcHRMaW5lTnVtYmVyKSB7DQogICAgICAgICR2ZXJzaW9uID0gR2V0LVNjcmlwdFZlcnNpb24NCiAgICAgICAgaWYgKC1ub3QgW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJHZlcnNpb24pKSB7DQogICAgICAgICAgICAkc2NyaXB0VmVyc2lvbiA9ICJWZXJzaW9uOiAkdmVyc2lvbi4gIg0KICAgICAgICB9DQoNCiAgICAgICAgJGVycm9yTWVzc2FnZUxpbmUgPSAkc2NyaXB0VmVyc2lvbiArICJMaW5lICckKCRNZXNzYWdlLkludm9jYXRpb25JbmZvLlNjcmlwdExpbmVOdW1iZXIpJzogIg0KICAgIH0NCg0KICAgICRob3N0LnVpLldyaXRlRXJyb3JMaW5lKCRlcnJvck1lc3NhZ2VMaW5lICsgJGV4Y2VwdGlvbk1lc3NhZ2UpDQp9DQoNCmZ1bmN0aW9uIEdldC1TY3JpcHRWZXJzaW9uIHsNCiAgICAkc2NyaXB0Q29udGVudCA9IEdldC1Db250ZW50ICRNeUludm9jYXRpb24uU2NyaXB0TmFtZSB8IE91dC1TdHJpbmcNCiAgICBpZiAoJHNjcmlwdENvbnRlbnQgLW5vdG1hdGNoICc8I1tcclxuXXsyfS5TWU5PUFNJU1teXCNcPl0qKC5OT1RFU1teXCNcPl0qKVwjPicpIHsgcmV0dXJuIH0NCg0KICAgICRoZWxwQmxvY2sgPSAkTWF0Y2hlc1sxXS5TcGxpdChbZW52aXJvbm1lbnRdOjpOZXdMaW5lKQ0KDQogICAgZm9yZWFjaCAoJGxpbmUgaW4gJGhlbHBCbG9jaykgew0KICAgICAgICBpZiAoJGxpbmUgLW1hdGNoICdWZXJzaW9uOicpIHsNCiAgICAgICAgICAgIHJldHVybiAkbGluZS5TcGxpdCgnOicpWzFdLlNwbGl0KCctJylbMF0uVHJpbSgpDQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIENvbmZpcm0tU3RyaW5nSXNOb3RFbXB0eSAoW3N0cmluZ10kVmFsdWUpIHsNCiAgICByZXR1cm4gLW5vdCBbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgoRm9ybWF0LVN0cmluZ1ZhbHVlIC1WYWx1ZSAkVmFsdWUpKQ0KfQ0KDQpmdW5jdGlvbiBGb3JtYXQtU3RyaW5nVmFsdWUgKFtzdHJpbmddJFZhbHVlKSB7DQogICAgcmV0dXJuICRWYWx1ZS5SZXBsYWNlKCciJywgJycpLlJlcGxhY2UoIiciLCAnJykuVHJpbSgpDQp9DQoNCmZ1bmN0aW9uIFRlc3QtUmVnaXN0cnlLZXlQcm9wZXJ0eSAoW3N0cmluZ10kS2V5LCBbc3RyaW5nXSRQcm9wZXJ0eSkgew0KICAgIGlmIChbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkS2V5KSkgeyByZXR1cm4gJGZhbHNlIH0NCiAgICBpZiAoVGVzdC1XT1c2NDMyUHJvY2Vzcykgew0KICAgICAgICAkcmVnU3Via2V5ID0gR2V0LVdPVzY0UmVnaXN0cnlTdWJLZXkgLUtleSAkS2V5IC1Qcm9wZXJ0eSAkUHJvcGVydHkgLVJlYWRPbmx5DQogICAgICAgIHJldHVybiAkbnVsbCAtbmUgJHJlZ1N1YmtleS5HZXRWYWx1ZSgkUHJvcGVydHkpDQogICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICRudWxsIC1uZSAoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkS2V5IGANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtTmFtZSAkUHJvcGVydHkgYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gVGVzdC1XT1c2NDMyUHJvY2VzcyB7DQogICAgcmV0dXJuIChUZXN0LVBhdGggRW52OlxQUk9DRVNTT1JfQVJDSElURVc2NDMyKQ0KfQ0KDQpmdW5jdGlvbiBHZXQtV09XNjRSZWdpc3RyeVN1YktleSAoW3N0cmluZ10kS2V5LCBbc3dpdGNoXSRSZWFkT25seSkgew0KICAgIHN3aXRjaCAtUmVnZXggKCRLZXkpIHsNCiAgICAgICAgJ15IS0xNOlxcKC4qKScgeyAkaGl2ZSA9ICJMb2NhbE1hY2hpbmUiIH0NCiAgICAgICAgJ15IS0NVOlxcKC4qKScgeyAkaGl2ZSA9ICJDdXJyZW50VXNlciIgfQ0KICAgIH0NCg0KICAgIHRyeSB7DQogICAgICAgICRyZWdLZXkgPSBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5XTo6T3BlbkJhc2VLZXkoJGhpdmUsW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeVZpZXddOjpSZWdpc3RyeTY0KQ0KDQogICAgICAgIHN3aXRjaCAoJFJlYWRPbmx5KSB7DQogICAgICAgICAgICAkdHJ1ZSB7IHJldHVybiAkcmVnS2V5Lk9wZW5TdWJLZXkoJE1hdGNoZXNbMV0pIH0NCiAgICAgICAgICAgICRmYWxzZSB7IHJldHVybiAkcmVnS2V5Lk9wZW5TdWJLZXkoJE1hdGNoZXNbMV0sJHRydWUpIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBjYXRjaCB7DQogICAgICAgICB0aHJvdyAnRXJyb3Igb3BlbmluZyByZWdpc3RyeSBoaXZlLiAnDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBHZXQtUmVnaXN0cnlLZXlQcm9wZXJ0eSAoW3N0cmluZ10kS2V5LCBbc3RyaW5nXSRQcm9wZXJ0eSkgew0KICAgIGlmIChbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkS2V5KSkgeyByZXR1cm4gfQ0KICAgIGlmIChUZXN0LVdPVzY0MzJQcm9jZXNzKSB7DQogICAgICAgICRyZWdTdWJrZXkgPSBHZXQtV09XNjRSZWdpc3RyeVN1YktleSAtS2V5ICRLZXkgLVByb3BlcnR5ICRQcm9wZXJ0eSAtUmVhZE9ubHkNCiAgICAgICAgcmV0dXJuICRyZWdTdWJrZXkuR2V0VmFsdWUoJFByb3BlcnR5KQ0KICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkS2V5IGANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1OYW1lICRQcm9wZXJ0eSBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSkgfA0KICAgICAgICAgICAgICAgICAgICBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSAkUHJvcGVydHkNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIFN0b3AtR2l2ZW5Qcm9jZXNzIChbc3RyaW5nXSRQcm9jZXNzTmFtZSkgew0KICAgIFN0b3AtUHJvY2VzcyAtTmFtZSAkUHJvY2Vzc05hbWUgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlDQogICAgZm9yICgkaSA9IDA7ICRpIC1sdCAkTlVNX1JFVFJJRVM7ICRpKyspIHsNCiAgICAgICAgU3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyAkUkVUUllfV0FJVF9NUw0KICAgICAgICBpZiAoLW5vdCAoVGVzdC1HaXZlblByb2Nlc3MgLVByb2Nlc3NOYW1lICRQcm9jZXNzTmFtZSkpIHsgcmV0dXJuICR0cnVlIH0NCiAgICB9DQogICAgcmV0dXJuICRmYWxzZQ0KfQ0KDQpmdW5jdGlvbiBUZXN0LUdpdmVuUHJvY2VzcyAoW3N0cmluZ10kUHJvY2Vzc05hbWUpIHsNCiAgICByZXR1cm4gJG51bGwgLW5lIChHZXQtR2l2ZW5Qcm9jZXNzIC1Qcm9jZXNzTmFtZSAkUHJvY2Vzc05hbWUpDQp9DQoNCmZ1bmN0aW9uIEdldC1HaXZlblByb2Nlc3MgKFtzdHJpbmddJFByb2Nlc3NOYW1lKSB7DQogICAgcmV0dXJuIEdldC1Qcm9jZXNzIC1OYW1lICRQcm9jZXNzTmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQ0KfQ0KDQojDQojIElucHV0IHBhcmFtZXRlciB2YWxpZGF0aW9uDQojDQpmdW5jdGlvbiBUZXN0LVVSTHNBcmVWYWxpZCB7DQogICAgaWYgKC1ub3QgKENvbmZpcm0tU3RyaW5nSXNOb3RFbXB0eSAtVmFsdWUgJFVSTHNUb0xvYWQpKSB7DQogICAgICAgIHRocm93ICIkKCRFUlJPUl9FWENFUFRJT05fVFlQRS5JbnB1dCkgVVJMIGlucHV0IGNhbm5vdCBiZSBlbXB0eS4gIg0KICAgIH0NCg0KICAgICRVUkxzID0gR2V0LVVSTHNUb0ludm9rZQ0KDQogICAgZm9yZWFjaCgkVVJMIGluICRVUkxzKXsNCiAgICAgICAgJFVSSSA9ICRVUkwgLWFzIFt1cmldDQogICAgICAgIGlmICgtbm90ICgkVVJJLklzV2VsbEZvcm1lZE9yaWdpbmFsU3RyaW5nKCkpKSB7IA0KICAgICAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLklucHV0KSAnJFVSTCcgaXMgbm90IGEgY29ycmVjdCBVUkwgZm9ybWF0LiAiDQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIEdldC1VUkxzVG9JbnZva2Ugew0KICAgIHJldHVybiAkVVJMc1RvTG9hZCAtU3BsaXQgIjsiDQp9DQoNCiMNCiMgRW52aXJvbm1lbnQgY2hlY2tzDQojDQpmdW5jdGlvbiBUZXN0LVN1cHBvcnRlZE1pY3Jvc29mdEVkZ2VWZXJzaW9uIHsNCiAgICBpZiAoLW5vdCAoVGVzdC1SZWdpc3RyeUtleVByb3BlcnR5IC1LZXkgJE1JQ1JPU09GVF9FREdFX1JFR0lTVFJZX0tFWSBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtUHJvcGVydHkgJE1JQ1JPU09GVF9FREdFX1JFR0lTVFJZX1BST1BFUlRZKSkgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuRW52aXJvbm1lbnQpIENocm9taXVtLWJhc2VkIE1pY3Jvc29mdCBFZGdlIGlzIG5vdCBpbnN0YWxsZWQuICINCiAgICB9DQoNCiAgICAkYnJvd3NlckV4ZWNQYXRoID0gR2V0LVJlZ2lzdHJ5S2V5UHJvcGVydHkgLUtleSAkTUlDUk9TT0ZUX0VER0VfUkVHSVNUUllfS0VZIGANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLVByb3BlcnR5ICRNSUNST1NPRlRfRURHRV9SRUdJU1RSWV9QUk9QRVJUWQ0KDQogICAgJGVkZ2VFeGVjdXRhYmxlSW5mbyA9IEdldC1JdGVtIC1QYXRoICRicm93c2VyRXhlY1BhdGgNCiAgICBpZiAoJG51bGwgLWVxICRlZGdlRXhlY3V0YWJsZUluZm8uVmVyc2lvbkluZm8gLW9yIGANCiAgICAgICAgJG51bGwgLWVxICRlZGdlRXhlY3V0YWJsZUluZm8uVmVyc2lvbkluZm8uUHJvZHVjdFZlcnNpb24pIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLkludGVybmFsKSBDb3VsZCBub3QgZ2V0IE1pY3Jvc29mdCBFZGdlIHZlcnNpb24gaW5mb3JtYXRpb24gZnJvbSB0aGUgZmlsZSAnJGJyb3dzZXJFeGVjUGF0aCcuICINCiAgICB9DQoNCiAgICAkZWRnZVZlcnNpb24gPSAkZWRnZUV4ZWN1dGFibGVJbmZvLlZlcnNpb25JbmZvLlByb2R1Y3RWZXJzaW9uIC1hcyBbdmVyc2lvbl0NCiAgICBpZiAoJG51bGwgLWVxICRlZGdlVmVyc2lvbikgew0KICAgICAgICB0aHJvdyAiJCgkRVJST1JfRVhDRVBUSU9OX1RZUEUuSW50ZXJuYWwpIFVuZXhwZWN0ZWQgdmVyc2lvbiB2YWx1ZSAnJCgkZWRnZUV4ZWN1dGFibGVJbmZvLlZlcnNpb25JbmZvLlByb2R1Y3RWZXJzaW9uKScgZ2F0aGVyZWQgZnJvbSB0aGUgZmlsZSAnJGJyb3dzZXJFeGVjUGF0aCcuICINCiAgICB9DQoNCiAgICBpZiAoJGVkZ2VWZXJzaW9uLk1ham9yIC1sdCAkTUlDUk9TT0ZUX0VER0VfU1VQUE9SVEVEX1ZFUlNJT04pIHsNCiAgICAgICAgdGhyb3cgIiQoJEVSUk9SX0VYQ0VQVElPTl9UWVBFLkVudmlyb25tZW50KSBUaGlzIHNjcmlwdCBpcyBjb21wYXRpYmxlIHdpdGggdGhlIENocm9taXVtLWJhc2VkIE1pY3Jvc29mdCBFZGdlICRNSUNST1NPRlRfRURHRV9TVVBQT1JURURfVkVSU0lPTiBvbndhcmRzLiAiDQogICAgfQ0KfQ0KDQojDQojIEVkZ2UgbWFuYWdlbWVudA0KIw0KZnVuY3Rpb24gSW52b2tlLUVkZ2VQcm9jZXNzIHsNCiAgICBJbnZva2UtVVJMRWRnZQ0KICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDMwDQogICAgU3RvcC1FZGdlUHJvY2Vzcw0KfQ0KDQpmdW5jdGlvbiBJbnZva2UtVVJMRWRnZSB7DQogICAgJFVSTHMgPSBHZXQtVVJMc1RvSW52b2tlDQoNCiAgICBmb3JlYWNoKCRVUkwgaW4gJFVSTHMpew0KICAgICAgICBTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAibXNlZGdlLmV4ZSIgLUFyZ3VtZW50TGlzdCAkVVJMDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBTdG9wLUVkZ2VQcm9jZXNzIHsNCiAgICBpZiAoLW5vdCAoU3RvcC1HaXZlblByb2Nlc3MgLVByb2Nlc3NOYW1lICRNSUNST1NPRlRfRURHRV9QUk9DRVNTX05BTUUpKSB7DQogICAgICAgIHRocm93ICIkKCRFUlJPUl9FWENFUFRJT05fVFlQRS5JbnRlcm5hbCkgVGhlcmUgd2FzIGFuIGVycm9yIHN0b3BwaW5nIE1pY3Jvc29mdCBFZGdlIHByb2Nlc3MuICINCiAgICB9DQp9DQoNCiMNCiMgTWFpbiBzY3JpcHQgZmxvdw0KIw0KW2Vudmlyb25tZW50XTo6RXhpdCgoSW52b2tlLU1haW4gLUlucHV0UGFyYW1ldGVycyAkTXlJbnZvY2F0aW9uLkJvdW5kUGFyYW1ldGVycykpDQo="}}}